import{r as t,o as e,c as o,b as c,w as p,F as l,f as u,a as n,d as s}from"./app.cbe66998.js";import{_ as r}from"./plugin-vue_export-helper.21dcd24c.js";const i={},k=u(`<h1 id="\u7B2C-4-\u7AE0-\u54CD\u5E94\u7CFB\u7EDF\u7684\u4F5C\u7528\u4E0E\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#\u7B2C-4-\u7AE0-\u54CD\u5E94\u7CFB\u7EDF\u7684\u4F5C\u7528\u4E0E\u5B9E\u73B0" aria-hidden="true">#</a> \u7B2C 4 \u7AE0 \u54CD\u5E94\u7CFB\u7EDF\u7684\u4F5C\u7528\u4E0E\u5B9E\u73B0</h1><p>\u54CD\u5E94\u7CFB\u7EDF\u662F Vue.js \u7684\u91CD\u8981\u7EC4\u6210\u90E8\u5206\uFF0CVue.js 3 \u91C7\u7528 Proxy \u5B9E\u73B0\u54CD\u5E94\u5F0F\u6570\u636E\u3002</p><h2 id="_4-1-\u54CD\u5E94\u5F0F\u6570\u636E\u4E0E\u526F\u4F5C\u7528\u51FD\u6570" tabindex="-1"><a class="header-anchor" href="#_4-1-\u54CD\u5E94\u5F0F\u6570\u636E\u4E0E\u526F\u4F5C\u7528\u51FD\u6570" aria-hidden="true">#</a> 4.1 \u54CD\u5E94\u5F0F\u6570\u636E\u4E0E\u526F\u4F5C\u7528\u51FD\u6570</h2><p>\u526F\u4F5C\u7528\u51FD\u6570\u662F\u6307\u4F1A\u4EA7\u751F\u526F\u4F5C\u7528\u7684\u51FD\u6570\u3002\u526F\u4F5C\u7528\u51FD\u6570\u7684\u6267\u884C\u4F1A\u76F4\u63A5\u6216\u95F4\u63A5\u5F71\u54CD\u5176\u4ED6\u7684\u53D8\u91CF\u6216\u5176\u4ED6\u51FD\u6570\u7684\u6267\u884C\u3002</p><p>\u5982\u4E0B\u6240\u793A\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&#39;hello world&#39;</span> <span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  state<span class="token punctuation">.</span>text <span class="token operator">=</span> obj<span class="token punctuation">.</span>text
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>innerText <span class="token operator">=</span> obj<span class="token punctuation">.</span>text
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>effect \u6267\u884C\u4F1A\u8BFB\u53D6 obj\uFF0C\u5E76\u8BBE\u7F6E state\uFF0C\u4EE5\u53CA\u66F4\u6539 DOM \u5143\u7D20\uFF0C\u8FD9\u4E2A\u5C31\u662F\u526F\u4F5C\u7528\u3002</p><p>\u4F46\u662F\uFF0Cobj.text \u6539\u4E86\u4E4B\u540E\uFF0C\u5E76\u4E0D\u4F1A\u81EA\u52A8\u6267\u884C effect \u51FD\u6570\u3002</p><h2 id="_4-2-\u54CD\u5E94\u5F0F\u6570\u636E\u7684\u57FA\u672C\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#_4-2-\u54CD\u5E94\u5F0F\u6570\u636E\u7684\u57FA\u672C\u5B9E\u73B0" aria-hidden="true">#</a> 4.2 \u54CD\u5E94\u5F0F\u6570\u636E\u7684\u57FA\u672C\u5B9E\u73B0</h2><p>\u89C2\u5BDF\u53EF\u4EE5\u770B\u51FA\uFF1A</p><ul><li>\u526F\u4F5C\u7528\u51FD\u6570 effect \u6267\u884C\u65F6\uFF0C\u4F1A\u51FA\u53D1 obj.text \u7684<strong>\u8BFB\u53D6</strong>\u64CD\u4F5C</li><li>\u4FEE\u6539 obj.text \u65F6\uFF0C\u4F1A\u89E6\u53D1<strong>\u8BBE\u7F6E</strong>\u64CD\u4F5C</li></ul><p>\u5982\u679C\u6211\u4EEC\u80FD\u62E6\u622A\u4E00\u4E2A\u5BF9\u8C61\u7684\u8BFB\u53D6\u548C\u8BBE\u7F6E\u64CD\u4F5C\uFF0C\u90A3\u4E48\u5C31\u80FD\u505A\u4E00\u4E9B\u989D\u5916\u7684\u64CD\u4F5C\u3002</p><p>\u5728 ES2015 \u4E4B\u524D\u53EA\u80FD\u901A\u8FC7 Object.defineProperty \u51FD\u6570\u5B9E\u73B0\uFF0C\u8FD9\u4E5F\u662F Vue.js 2 \u6240\u91C7\u7528\u7684\u65B9\u5F0F\u3002\u5728 ES2015+ \u4E2D\uFF0C\u53EF\u4EE5\u4F7F\u7528\u4EE3\u7406\u5BF9\u8C61 Proxy \u6765\u5B9E\u73B0\uFF0C\u8FD9\u4E5F\u662F Vue.js 3 \u6240\u91C7\u7528\u7684\u65B9\u5F0F\u3002</p><div class="custom-container note"><p class="custom-container-title">Proxy \u793A\u4F8B</p><div id="effect-proxy-demo"></div></div>`,14),E=n("div",{class:"language-html ext-html line-numbers-mode"},[n("pre",{class:"language-html"},[n("code",null,[n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("div")]),s(),n("span",{class:"token attr-name"},"id"),n("span",{class:"token attr-value"},[n("span",{class:"token punctuation attr-equals"},"="),n("span",{class:"token punctuation"},'"'),s("effect-proxy-demo"),n("span",{class:"token punctuation"},'"')]),n("span",{class:"token punctuation"},">")]),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("div")]),n("span",{class:"token punctuation"},">")]),s(`
`),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("button")]),s(),n("span",{class:"token special-attr"},[n("span",{class:"token attr-name"},"onclick"),n("span",{class:"token attr-value"},[n("span",{class:"token punctuation attr-equals"},"="),n("span",{class:"token punctuation"},'"'),n("span",{class:"token value javascript language-javascript"},[n("span",{class:"token function"},"changeText"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")")]),n("span",{class:"token punctuation"},'"')])]),n("span",{class:"token punctuation"},">")]),s("Change Text"),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("button")]),n("span",{class:"token punctuation"},">")]),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("span",{class:"line-number"},"1"),n("br"),n("span",{class:"line-number"},"2"),n("br")])],-1),b=n("div",{class:"language-javascript ext-js line-numbers-mode"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// \u5B58\u50A8\u526F\u4F5C\u7528\u51FD\u6570\u7684\u6876"),s(`
`),n("span",{class:"token keyword"},"const"),s(" bucket "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Set"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// \u539F\u59CB\u6570\u636E"),s(`
`),n("span",{class:"token keyword"},"const"),s(" data "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"text"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'hello world'"),s(),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token comment"},"// \u5BF9\u539F\u59CB\u6570\u636E\u7684\u4EE3\u7406"),s(`
`),n("span",{class:"token keyword"},"const"),s(" obj "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Proxy"),n("span",{class:"token punctuation"},"("),s("data"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// \u62E6\u622A\u8BFB\u53D6\u64CD\u4F5C"),s(`
  `),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),s("target"),n("span",{class:"token punctuation"},","),s(" key"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token comment"},"// \u5C06\u526F\u4F5C\u7528\u51FD\u6570 effect \u6DFB\u52A0\u5230\u526F\u4F5C\u7528\u51FD\u6570\u6876\u4E2D"),s(`
    bucket`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"add"),n("span",{class:"token punctuation"},"("),s("effect"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token comment"},"// \u8FD4\u56DE\u5C5E\u6027\u503C"),s(`
    `),n("span",{class:"token keyword"},"return"),s(" target"),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// \u62E6\u622A\u8BBE\u7F6E\u64CD\u4F5C"),s(`
  `),n("span",{class:"token function"},"set"),n("span",{class:"token punctuation"},"("),s("target"),n("span",{class:"token punctuation"},","),s(" key"),n("span",{class:"token punctuation"},","),s(" newVal"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token comment"},"// \u8BBE\u7F6E\u5C5E\u6027\u503C"),s(`
    target`),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(` newVal
    `),n("span",{class:"token comment"},"// \u628A\u526F\u4F5C\u7528\u51FD\u6570\u4ECE\u6876\u4E2D\u53D6\u51FA\u6765\u5E76\u6267\u884C"),s(`
    bucket`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"fn"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"fn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token comment"},"// \u8FD4\u56DE true \u4EE3\u8868 \u8BBE\u7F6E\u6210\u529F"),s(`
    `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token boolean"},"true"),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// \u526F\u4F5C\u7528\u51FD\u6570"),s(`
`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  window`),n("span",{class:"token punctuation"},"."),s("document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"querySelector"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'#effect-proxy-demo'"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("innerText "),n("span",{class:"token operator"},"="),s(" obj"),n("span",{class:"token punctuation"},"."),s(`text
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token comment"},"// \u6267\u884C\u526F\u4F5C\u7528\u51FD\u6570\uFF0C\u89E6\u53D1\u8BFB\u53D6"),s(`
`),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"changeText"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  obj`),n("span",{class:"token punctuation"},"."),s("text "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},"'hello vue3'"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("span",{class:"line-number"},"1"),n("br"),n("span",{class:"line-number"},"2"),n("br"),n("span",{class:"line-number"},"3"),n("br"),n("span",{class:"line-number"},"4"),n("br"),n("span",{class:"line-number"},"5"),n("br"),n("span",{class:"line-number"},"6"),n("br"),n("span",{class:"line-number"},"7"),n("br"),n("span",{class:"line-number"},"8"),n("br"),n("span",{class:"line-number"},"9"),n("br"),n("span",{class:"line-number"},"10"),n("br"),n("span",{class:"line-number"},"11"),n("br"),n("span",{class:"line-number"},"12"),n("br"),n("span",{class:"line-number"},"13"),n("br"),n("span",{class:"line-number"},"14"),n("br"),n("span",{class:"line-number"},"15"),n("br"),n("span",{class:"line-number"},"16"),n("br"),n("span",{class:"line-number"},"17"),n("br"),n("span",{class:"line-number"},"18"),n("br"),n("span",{class:"line-number"},"19"),n("br"),n("span",{class:"line-number"},"20"),n("br"),n("span",{class:"line-number"},"21"),n("br"),n("span",{class:"line-number"},"22"),n("br"),n("span",{class:"line-number"},"23"),n("br"),n("span",{class:"line-number"},"24"),n("br"),n("span",{class:"line-number"},"25"),n("br"),n("span",{class:"line-number"},"26"),n("br"),n("span",{class:"line-number"},"27"),n("br"),n("span",{class:"line-number"},"28"),n("br"),n("span",{class:"line-number"},"29"),n("br"),n("span",{class:"line-number"},"30"),n("br"),n("span",{class:"line-number"},"31"),n("br"),n("span",{class:"line-number"},"32"),n("br"),n("span",{class:"line-number"},"33"),n("br"),n("span",{class:"line-number"},"34"),n("br"),n("span",{class:"line-number"},"35"),n("br"),n("span",{class:"line-number"},"36"),n("br")])],-1),m=n("p",null,"\u4E0A\u8FF0\u793A\u4F8B\uFF0C\u53EF\u4EE5\u8FBE\u5230\u54CD\u5E94\u5F0F\u7684\u7ED3\u679C\u3002",-1),d=n("h2",{id:"_4-3-\u8BBE\u8BA1\u4E00\u4E2A\u5B8C\u5584\u7684\u54CD\u5E94\u5F0F\u7CFB\u7EDF",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_4-3-\u8BBE\u8BA1\u4E00\u4E2A\u5B8C\u5584\u7684\u54CD\u5E94\u5F0F\u7CFB\u7EDF","aria-hidden":"true"},"#"),s(" 4.3 \u8BBE\u8BA1\u4E00\u4E2A\u5B8C\u5584\u7684\u54CD\u5E94\u5F0F\u7CFB\u7EDF")],-1);function B(C,f){const a=t("CodeDemo");return e(),o(l,null,[k,c(a,{id:"code-demo-6e1daf30",title:"Proxy%20%E7%A4%BA%E4%BE%8B",code:"%7B%22html%22%3A%22%3Cdiv%20id%3D%5C%22effect-proxy-demo%5C%22%3E%3C%2Fdiv%3E%5Cn%3Cbutton%20onclick%3D%5C%22changeText()%5C%22%3EChange%20Text%3C%2Fbutton%3E%5Cn%22%2C%22js%22%3A%22%2F%2F%20%E5%AD%98%E5%82%A8%E5%89%AF%E4%BD%9C%E7%94%A8%E5%87%BD%E6%95%B0%E7%9A%84%E6%A1%B6%5Cnconst%20bucket%20%3D%20new%20Set()%5Cn%5Cn%2F%2F%20%E5%8E%9F%E5%A7%8B%E6%95%B0%E6%8D%AE%5Cnconst%20data%20%3D%20%7B%20text%3A%20'hello%20world'%20%7D%5Cn%2F%2F%20%E5%AF%B9%E5%8E%9F%E5%A7%8B%E6%95%B0%E6%8D%AE%E7%9A%84%E4%BB%A3%E7%90%86%5Cnconst%20obj%20%3D%20new%20Proxy(data%2C%20%7B%5Cn%20%20%2F%2F%20%E6%8B%A6%E6%88%AA%E8%AF%BB%E5%8F%96%E6%93%8D%E4%BD%9C%5Cn%20%20get(target%2C%20key)%20%7B%5Cn%20%20%20%20%2F%2F%20%E5%B0%86%E5%89%AF%E4%BD%9C%E7%94%A8%E5%87%BD%E6%95%B0%20effect%20%E6%B7%BB%E5%8A%A0%E5%88%B0%E5%89%AF%E4%BD%9C%E7%94%A8%E5%87%BD%E6%95%B0%E6%A1%B6%E4%B8%AD%5Cn%20%20%20%20bucket.add(effect)%5Cn%20%20%20%20%2F%2F%20%E8%BF%94%E5%9B%9E%E5%B1%9E%E6%80%A7%E5%80%BC%5Cn%20%20%20%20return%20target%5Bkey%5D%5Cn%20%20%7D%2C%5Cn%20%20%2F%2F%20%E6%8B%A6%E6%88%AA%E8%AE%BE%E7%BD%AE%E6%93%8D%E4%BD%9C%5Cn%20%20set(target%2C%20key%2C%20newVal)%20%7B%5Cn%20%20%20%20%2F%2F%20%E8%AE%BE%E7%BD%AE%E5%B1%9E%E6%80%A7%E5%80%BC%5Cn%20%20%20%20target%5Bkey%5D%20%3D%20newVal%5Cn%20%20%20%20%2F%2F%20%E6%8A%8A%E5%89%AF%E4%BD%9C%E7%94%A8%E5%87%BD%E6%95%B0%E4%BB%8E%E6%A1%B6%E4%B8%AD%E5%8F%96%E5%87%BA%E6%9D%A5%E5%B9%B6%E6%89%A7%E8%A1%8C%5Cn%20%20%20%20bucket.forEach((fn)%20%3D%3E%20fn())%5Cn%20%20%20%20%2F%2F%20%E8%BF%94%E5%9B%9E%20true%20%E4%BB%A3%E8%A1%A8%20%E8%AE%BE%E7%BD%AE%E6%88%90%E5%8A%9F%5Cn%20%20%20%20return%20true%5Cn%20%20%7D%2C%5Cn%7D)%5Cn%5Cn%2F%2F%20%E5%89%AF%E4%BD%9C%E7%94%A8%E5%87%BD%E6%95%B0%5Cnfunction%20effect()%20%7B%5Cn%20%20window.document.querySelector('%23effect-proxy-demo').innerText%20%3D%20obj.text%5Cn%7D%5Cn%5Cn%2F%2F%20%E6%89%A7%E8%A1%8C%E5%89%AF%E4%BD%9C%E7%94%A8%E5%87%BD%E6%95%B0%EF%BC%8C%E8%A7%A6%E5%8F%91%E8%AF%BB%E5%8F%96%5Cneffect()%5Cn%5Cnfunction%20changeText()%20%7B%5Cn%20%20obj.text%20%3D%20'hello%20vue3'%5Cn%7D%5Cn%22%7D"},{default:p(()=>[E,b]),_:1}),m,d],64)}var g=r(i,[["render",B],["__file","chapter04.html.vue"]]);export{g as default};
