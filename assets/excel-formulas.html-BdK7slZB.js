import{_ as s,c as a,a as t,o as e}from"./app-BARUYhtD.js";const h={};function l(n,i){return e(),a("div",null,i[0]||(i[0]=[t('<h1 id="excel-公式" tabindex="-1"><a class="header-anchor" href="#excel-公式"><span>Excel 公式</span></a></h1><h2 id="使用公式查找字符的最后一次出现位置" tabindex="-1"><a class="header-anchor" href="#使用公式查找字符的最后一次出现位置"><span>使用公式查找字符的最后一次出现位置</span></a></h2><p><a href="https://zhuanlan.zhihu.com/p/511190534" target="_blank" rel="noopener noreferrer">定位字符最后一次出现的位置</a></p><p>公式</p><div class="language-vb" data-highlighter="shiki" data-ext="vb" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-vb"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">SEARCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;@&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">SUBSTITUTE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(查找单元格,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;查找字符串&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;@&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">LEN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(查找单元格)-</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">LEN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">SUBSTITUTE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(查找单元格,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;查找字符串&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))),</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre></div><p>解读</p><ol><li><p>首先需要计算出指定的字符在字符串中出现的次数。</p><p>例如，计算B3单元格中A的出现次数，可以用公式：<code>LEN(B3)-LEN(SUBSTITUTE(B3,&quot;A&quot;,&quot;&quot;))</code> 来实现，即字符串原来的长度减去去掉A字符的长度，则为A字符出现的次数（5次）。</p></li><li><p>然后用 <code>Substitute</code> 函数将最后一次出现的 “A” 替换为新的字符，如替换为 <code>@</code>。</p><p><code>SUBSTITUTE(B3,&quot;A&quot;,&quot;@&quot;,LEN(B3)-LEN(SUBSTITUTE(B3,&quot;A&quot;,&quot;&quot;)))</code></p></li><li><p>用 <code>Search</code> 函数定位 <code>@</code> 的位置即可。</p></li></ol><p>类似</p><p><a href="https://zh-cn.extendoffice.com/documents/excel/1968-excel-get-the-last-occurrence-of-a-character.html" target="_blank" rel="noopener noreferrer">Excel 中查找字符的第一次、最后一次或第 n 次出现位置</a></p><h2 id="获取文件扩展名" tabindex="-1"><a class="header-anchor" href="#获取文件扩展名"><span>获取文件扩展名</span></a></h2><p>公式</p><div class="language-vb" data-highlighter="shiki" data-ext="vb" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-vb"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">TRIM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">RIGHT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">SUBSTITUTE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(单元格,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;.&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">REPT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot; &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">LEN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(单元格))),</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">LEN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(单元格)))</span></span></code></pre></div><p>解读</p><ol><li>将对象字符串里的 <code>.</code> 替换为字符串长度的空格</li><li>截取右侧字符串长度的字符串</li><li>去掉多余空格</li></ol>',14)]))}const k=s(h,[["render",l]]),r=JSON.parse('{"path":"/notes/other/office/excel-formulas.html","title":"Excel 公式","lang":"zh-CN","frontmatter":{"category":["office"],"tag":["excel"],"description":"Excel 公式 使用公式查找字符的最后一次出现位置 定位字符最后一次出现的位置 公式 解读 首先需要计算出指定的字符在字符串中出现的次数。 例如，计算B3单元格中A的出现次数，可以用公式：LEN(B3)-LEN(SUBSTITUTE(B3,\\"A\\",\\"\\")) 来实现，即字符串原来的长度减去去掉A字符的长度，则为A字符出现的次数（5次）。 然后用 Sub...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Excel 公式\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-08-07T03:10:26.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Zhao Bin\\",\\"url\\":\\"zhaobc.site\\",\\"email\\":\\"hi@zhaobc.site\\"}]}"],["meta",{"property":"og:url","content":"https://www.zhaobc.site/notes/other/office/excel-formulas.html"}],["meta",{"property":"og:site_name","content":"赵斌的小站"}],["meta",{"property":"og:title","content":"Excel 公式"}],["meta",{"property":"og:description","content":"Excel 公式 使用公式查找字符的最后一次出现位置 定位字符最后一次出现的位置 公式 解读 首先需要计算出指定的字符在字符串中出现的次数。 例如，计算B3单元格中A的出现次数，可以用公式：LEN(B3)-LEN(SUBSTITUTE(B3,\\"A\\",\\"\\")) 来实现，即字符串原来的长度减去去掉A字符的长度，则为A字符出现的次数（5次）。 然后用 Sub..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-08-07T03:10:26.000Z"}],["meta",{"property":"article:tag","content":"excel"}],["meta",{"property":"article:modified_time","content":"2025-08-07T03:10:26.000Z"}],["link",{"rel":"alternate","type":"application/rss+xml","href":"https://www.zhaobc.site/rss.xml","title":"赵斌的小站 RSS Feed"}]]},"git":{"createdTime":1754536226000,"updatedTime":1754536226000,"contributors":[{"name":"Zhao Bin","username":"","email":"413853119@qq.com","commits":1}]},"readingTime":{"minutes":1.05,"words":316},"filePathRelative":"notes/other/office/excel-formulas.md","excerpt":"\\n<h2>使用公式查找字符的最后一次出现位置</h2>\\n<p><a href=\\"https://zhuanlan.zhihu.com/p/511190534\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">定位字符最后一次出现的位置</a></p>\\n<p>公式</p>\\n<div class=\\"language-vb\\" data-highlighter=\\"shiki\\" data-ext=\\"vb\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code class=\\"language-vb\\"><span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">=</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">SEARCH</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">(</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\\"@\\"</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">SUBSTITUTE</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">(查找单元格,</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\\"查找字符串\\"</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\\"@\\"</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\\">LEN</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">(查找单元格)-</span><span style=\\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\\">LEN</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">(</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">SUBSTITUTE</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">(查找单元格,</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\\"查找字符串\\"</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">,</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\\"\\"</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">))),</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\">1</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">)</span></span></code></pre>\\n</div>","autoDesc":true}');export{k as comp,r as data};
