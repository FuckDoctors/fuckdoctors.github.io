import{_ as i,c as a,a as n,o as t}from"./app-Bn99AUij.js";const h={};function l(k,s){return t(),a("div",null,s[0]||(s[0]=[n(`<h1 id="excel-workday-判断工作日" tabindex="-1"><a class="header-anchor" href="#excel-workday-判断工作日"><span>Excel workday 判断工作日</span></a></h1><p>Excel 中虽然提供了 <code>workday</code> 函数，可以用来判断是否是工作日，但是如果有节假日，或者是我们中国的调休的话，这个 <code>workday</code> 就没办法使用了。</p><p>那么有没有好办法来实现包含调休的工作日判断呢？<br> 那就是只能自己自定义函数来实现了。</p><h2 id="自定义-workday-函数" tabindex="-1"><a class="header-anchor" href="#自定义-workday-函数"><span>自定义 workday 函数</span></a></h2><p>下面是本人的自定义的 workday 函数，命名为 <code>workday2</code>。<br> 配合自己设置的日历实现工作日的判断。</p><h3 id="节假日和调休设置" tabindex="-1"><a class="header-anchor" href="#节假日和调休设置"><span>节假日和调休设置</span></a></h3><table><thead><tr><th>A</th><th>B</th><th>C</th><th>D</th></tr></thead><tbody><tr><td>节假日=&gt;</td><td>2024/44</td><td>调休出勤=&gt;</td><td>2024/4/7</td></tr><tr><td></td><td>2024/4/5</td><td></td><td>2024/4/28</td></tr><tr><td></td><td>2024/5/1</td><td></td><td>2024/5/11</td></tr><tr><td></td><td>2024/5/2</td><td></td><td>2024/9/14</td></tr><tr><td></td><td>2024/5/3</td><td></td><td>2024/9/29</td></tr><tr><td></td><td>2024/6/10</td><td></td><td>2024/10/12</td></tr><tr><td></td><td>2024/9/16</td><td></td><td></td></tr><tr><td></td><td>2024/9/17</td><td></td><td></td></tr><tr><td></td><td>2024/10/1</td><td></td><td></td></tr><tr><td></td><td>2024/10/2</td><td></td><td></td></tr><tr><td></td><td>2024/10/3</td><td></td><td></td></tr><tr><td></td><td>2024/10/4</td><td></td><td></td></tr><tr><td></td><td>2024/10/5</td><td></td><td></td></tr><tr><td></td><td>2024/10/6</td><td></td><td></td></tr><tr><td></td><td>2024/10/7</td><td></td><td></td></tr></tbody></table><h3 id="代码" tabindex="-1"><a class="header-anchor" href="#代码"><span>代码</span></a></h3><div class="language-vb" data-highlighter="shiki" data-ext="vb" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-vb"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">&#39; start: 开始日</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">&#39; days: 任务需要几天</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">&#39; 节假日列表</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">&#39; 调休出勤日列表</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">&#39; 返回从开始日开始几天后的工作日日期</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">Function</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Workday2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic;">start As Date, days As Integer, holidays As Variant, nonOffdays As Variant</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    Dim</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> collHolidays </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">As</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> New </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Collection</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    Dim</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> collNonOffDays </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">As</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> New </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Collection</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    Dim</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> dtEnd </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">As </span><span style="--shiki-light:#0184BC;--shiki-dark:#E5C07B;">Date</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    Dim</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> dtTmp </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">As </span><span style="--shiki-light:#0184BC;--shiki-dark:#E5C07B;">Date</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    Dim</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> tmp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() As </span><span style="--shiki-light:#0184BC;--shiki-dark:#E5C07B;">Variant</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    Dim</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> i </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">As </span><span style="--shiki-light:#0184BC;--shiki-dark:#E5C07B;">Long</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    If</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Not holidays Is</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> Nothing</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> Then</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        tmp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = holidays.Value</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        Set </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">collHolidays</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">arr2coll</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">tmp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    End If</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    If</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Not nonOffdays Is</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> Nothing</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> Then</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        tmp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = nonOffdays.Value</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        Set </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">collNonOffDays</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">arr2coll</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">tmp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    End If</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    i</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    dtTmp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> start</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    Do</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> While</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> days</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        If</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> CollectionContains</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">collHolidays</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> dtTmp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">Then</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            &#39; holidays</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">            dtTmp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">DateAdd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;d&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> dtTmp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        Else</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            &#39; non-holidays</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            If</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> CollectionContains</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">collNonOffDays</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> dtTmp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">Then</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    &#39; workday</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                    If</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> days</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> Then</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">                        dtTmp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">DateAdd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;d&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> dtTmp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                    End If</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">                    i</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> + </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            ElseIf</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> IsWeekend</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dtTmp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">Then</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">                    dtTmp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">DateAdd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;d&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> dtTmp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            Else</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                &#39; workday</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                If</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> days</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> Then</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">                    dtTmp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">DateAdd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;d&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> dtTmp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                End If</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">                i</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> + </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            End If</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        End If</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    Loop</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    Workday2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> dtTmp</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">End Function</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">Function</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> arr2coll</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic;">arr As Variant</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) As Collection</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    Dim</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> coll </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">As</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> New </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Collection</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    Dim</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> arrSize1 </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">As </span><span style="--shiki-light:#0184BC;--shiki-dark:#E5C07B;">Long</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    Dim</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> arrSize2 </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">As </span><span style="--shiki-light:#0184BC;--shiki-dark:#E5C07B;">Long</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">&#39;    If arr Is Nothing Then</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">&#39;        Set arr2coll = coll</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">&#39;        Exit Function</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">&#39;    End If</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    arrSize1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">UBound</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">arr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    arrSize2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">UBound</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">arr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    For</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> To</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> arrSize1</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        For</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> j</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> To</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> arrSize2</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            If</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> arr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> j</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) &lt;&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> Then</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                coll.</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">Add</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> arr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> j</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            End If</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        Next</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> j</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    Next</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> i</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    Set </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">arr2coll</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> coll</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">End Function</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">Function</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> CollectionContains</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic;">coll As Collection, checkVal As Variant</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) As Boolean</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    On Error Resume Next</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    CollectionContains</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> False</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    Dim</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> it </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">As </span><span style="--shiki-light:#0184BC;--shiki-dark:#E5C07B;">Variant</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    For</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> Each</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> it In coll</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        If</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> it</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> checkVal</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> Then</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">            CollectionContains</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> True</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            Exit Function</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        End If</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    Next</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">End Function</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">Public Function </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">IsWeekend</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">InputDate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> As </span><span style="--shiki-light:#0184BC;--shiki-dark:#E5C07B;">Date</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) As </span><span style="--shiki-light:#0184BC;--shiki-dark:#E5C07B;">Boolean</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    Select</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> Case</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> Weekday</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">InputDate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        Case</span><span style="--shiki-light:#0184BC;--shiki-dark:#E5C07B;"> vbSaturday</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> vbSunday</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">            IsWeekend</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> True</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        Case</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> Else</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">            IsWeekend</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> False</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    End Select</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">End Function</span></span></code></pre></div><h3 id="用法" tabindex="-1"><a class="header-anchor" href="#用法"><span>用法</span></a></h3><p>比如想实现一个任务编排工具，指定了这个任务的开始日和天数后，自动算出它的结束日，并且结束日得能自动跳过节假日，并且能适应调休。</p><p>比如：</p><table><thead><tr><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th></tr></thead><tbody><tr><td>编号</td><td>任务</td><td>天数</td><td>开始日</td><td>终了日</td></tr><tr><td>1</td><td>t1</td><td>8</td><td>2024/4/30</td><td><code>=WORKDAY2(D4,C4,calendar!$B$1:$B$30,calendar!$D$1:$D$20)</code> =&gt; 2024/5/13</td></tr></tbody></table><h2 id="补充" tabindex="-1"><a class="header-anchor" href="#补充"><span>补充</span></a></h2><p>这实际上是一个简易任务编排工具的一个主要功能。这个简易任务编排工具可以按一个人的一组任务自动算出这些任务的开始日和终了日。</p>`,15)]))}const e=i(h,[["render",l]]),d=JSON.parse('{"path":"/posts/private/excel-workday.html","title":"Excel workday 判断工作日","lang":"zh-CN","frontmatter":{"article":false,"llmstxt":false,"date":"2025-07-25T00:00:00.000Z","head":[["meta",{"name":"description","content":"Excel workday 判断工作日"}],["link",{"rel":"alternate","type":"application/rss+xml","href":"https://www.zhaobc.site/rss.xml","title":"赵斌的小站 RSS Feed"}]],"feed":false,"seo":false},"git":{},"readingTime":{"minutes":2.25,"words":675},"filePathRelative":"posts/private/excel-workday.md"}');export{e as comp,d as data};
