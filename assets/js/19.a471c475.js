(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{552:function(s,t,a){s.exports=a.p+"assets/img/http-https-ssh.ef67756c.png"},553:function(s,t,a){s.exports=a.p+"assets/img/ipv6-settings.1ef357e1.png"},730:function(s,t,a){"use strict";a.r(t);var n=a(4),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"路由器折腾笔记"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#路由器折腾笔记"}},[s._v("#")]),s._v(" 路由器折腾笔记")]),s._v(" "),n("h2",{attrs:{id:"刷机"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#刷机"}},[s._v("#")]),s._v(" 刷机")]),s._v(" "),n("p",[s._v("路由器型号为 newifi3-d2，咸鱼上『拣』的垃圾，当然不是免费的，为了 d2 版本挑拣的矿机。")]),s._v(" "),n("p",[s._v("到手后，刷了 breed，然后刷了 padavan，本人小白，所以选了 padavan。")]),s._v(" "),n("p",[s._v("之前很早的时候，newifi1 用过 openwrt，主要看中的是多拨，后来升级带宽，感觉够用了，而且感觉多拨也没怎么提升，padavan 功能整合的挺好就刷了 padavan，所以就一直沿用下来了。")]),s._v(" "),n("p",[s._v("（多拨没提升，估计是我网线的事，原来埋的是百兆线，padavan 上没多拨也是个遗憾吧）")]),s._v(" "),n("h2",{attrs:{id:"padavan-外网访问"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#padavan-外网访问"}},[s._v("#")]),s._v(" padavan 外网访问")]),s._v(" "),n("p",[s._v("路由器刷了 padavan 后感觉功能很强大，但是基本没啥用，但是总想搞事情。")]),s._v(" "),n("p",[s._v("逛恩山论坛后，看到大家在刷翻墙，奈何自己没服务器，只能作罢。还看到大家在搞外网访问，虽然自己没啥用，但是感觉大家在搞，我也想搞搞，而且自己也正好有域名。")]),s._v(" "),n("p",[s._v("但是，之前买的 3 年的域名到期了，看着续费也不便宜（其实是穷。。。），自己不怎么用，所以就不续费了。新注册反而更便宜，那还是新注册个吧，反正之前的域名也没啥用。。。")]),s._v(" "),n("p",[s._v("鉴于上次买的域名时间短，这次想搞个时间长的，省得续费还贵，一次性搞了 10 年，对比了一下虽然腾讯域名比阿里域名便宜一点，但是鉴于腾讯的也不能用 Q 币（正好有闲置），而且之前阿里上的域名也都用过，所以还是选择了阿里。")]),s._v(" "),n("p",[s._v("上面废话了一通，这次回归正题，按以下几点实现外部访问。")]),s._v(" "),n("ol",[n("li",[s._v("自己有域名后，可以配合 padavan 的"),n("code",[s._v("Aliddns")]),s._v("功能解析到域名下。\n"),n("ul",[n("li",[s._v("配置阿里域名，获取 Access Key 的相关信息，使用"),n("code",[s._v("RAM 用户")]),s._v("，配置了"),n("code",[s._v("管理云解析（DNS）的权限")]),s._v("和"),n("code",[s._v("管理域名服务的权限")]),s._v("。")]),s._v(" "),n("li",[s._v("使用"),n("code",[s._v("Aliddns")]),s._v("配置。"),n("a",{attrs:{href:"http://192.168.123.1/Advanced_Extensions_aliddns.asp",target:"_blank",rel:"noopener noreferrer"}},[s._v("配置链接"),n("OutboundLink")],1),s._v("："),n("code",[s._v("http://192.168.123.1/Advanced_Extensions_aliddns.asp")])])])]),s._v(" "),n("li",[s._v("确保开启了路由的"),n("code",[s._v("HTTP Web 服务")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://192.168.123.1/Advanced_Services_Content.asp",target:"_blank",rel:"noopener noreferrer"}},[s._v("配置链接"),n("OutboundLink")],1),s._v("："),n("code",[s._v("http://192.168.123.1/Advanced_Services_Content.asp")])]),s._v(" "),n("li",[s._v("开启 HTTP & HTTPS 服务，如下所示：\n"),n("img",{attrs:{src:a(552),alt:"开启HTTP & HTTPS"}})]),s._v(" "),n("li",[s._v("此处同时开启了 ssh 服务")])])]),s._v(" "),n("li",[s._v("使用 frp 实现内网穿透\n"),n("ul",[n("li",[n("a",{attrs:{href:"http://192.168.123.1/Advanced_Extensions_frp.asp",target:"_blank",rel:"noopener noreferrer"}},[s._v("配置链接"),n("OutboundLink")],1),s._v("："),n("code",[s._v("http://192.168.123.1/Advanced_Extensions_frp.asp")])]),s._v(" "),n("li",[s._v("配置脚本"),n("code",[s._v("frp_scripts")]),s._v("\n为了简便，这里只说明修改部分。")])])])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ==========客户端配置：==========")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("common"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nserver_addr "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 自己的域名\nserver_port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7000")]),s._v("\ntoken "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 自己设置一个token，跟服务器端一致即可\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("web"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" http\nlocal_port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 跟上面HTTP Web服务的的端口保持一致")]),s._v("\nremote_port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 自己设置一个端口 "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里注意一下，一般运营上会屏蔽80端口，使用其他端口。")]),s._v("\ncustom_domains "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 自己的域名\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("https"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" https\nlocal_port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 跟上面HTTPS Web服务的的端口保持一致")]),s._v("\nremote_port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" https的端口 "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 自己配置一个https的端口")]),s._v("\ncustom_domains "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 自己的域名\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ssh"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tcp\nlocal_port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("\nremote_port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ssh的端口\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ==========服务端配置：==========")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("common"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nbind_port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7000")]),s._v("\ndashboard_port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7500")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dashboard 用户名密码，默认都为 admin")]),s._v("\ndashboard_user "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" admin\ndashboard_pwd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" admin\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过自定义域名访问部署于内网的 web 服务")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# https://github.com/fatedier/frp/blob/master/README_zh.md#%E9%80%9A%E8%BF%87%E8%87%AA%E5%AE%9A%E4%B9%89%E5%9F%9F%E5%90%8D%E8%AE%BF%E9%97%AE%E9%83%A8%E7%BD%B2%E4%BA%8E%E5%86%85%E7%BD%91%E7%9A%84-web-%E6%9C%8D%E5%8A%A1")]),s._v("\nvhost_http_port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 供外网访问的http端口，跟上面的http的remote_port保持一致\nvhost_https_port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 供外网访问的https端口，跟上面的https的remote_port保持一致\ntoken "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 跟客户端的token保持一致\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br")])]),n("ul",[n("li",[s._v("特别说明\n"),n("ul",[n("li",[s._v("http 的"),n("code",[s._v("remote_port")]),s._v("遇到过一个坑，最初设置的 8080 能正常范围，后来不知啥时候不能访问了，一开始以为配置错了，各种调整依然不行，后来发现设为别的端口就可以，估计是 8080 也被运营商封掉了。。。")]),s._v(" "),n("li",[s._v("https 的 443 也被运行商封掉了，换用其他端口。")])])])]),s._v(" "),n("ol",{attrs:{start:"4"}},[n("li",[n("p",[s._v("配置端口转发")]),s._v(" "),n("ul",[n("li",[s._v("为了定制更多端口转发，我在"),n("code",[s._v("外部网络 (WAN) - 端口转发 (UPnP)")]),s._v("中自己设的")]),s._v(" "),n("li",[s._v("也可以在"),n("code",[s._v("防火墙 - 通用设置")]),s._v("中开启")])])]),s._v(" "),n("li",[n("p",[s._v("SSL 证书\n需要启用 https 的话，需要申请免费或购买收费证书，得到正数后，将证书内容填到下面两项内。")]),s._v(" "),n("p",[s._v("位置："),n("code",[s._v("系统管理 - 服务")])]),s._v(" "),n("p",[s._v("配置项：")]),s._v(" "),n("ul",[n("li",[s._v("Server Certificate (required)")]),s._v(" "),n("li",[s._v("Server Private Key (required)")])])])]),s._v(" "),n("p",[s._v("不出意外，就可以外网访问了，如有意外，先检查配置，再网络搜索。")]),s._v(" "),n("h2",{attrs:{id:"开启-ipv6-外网访问"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#开启-ipv6-外网访问"}},[s._v("#")]),s._v(" 开启 IPv6 外网访问")]),s._v(" "),n("p",[s._v("运营上已支持 IPv6，路由里也自动获得了 IPv6。")]),s._v(" "),n("ol",[n("li",[s._v("默认配置：\n"),n("img",{attrs:{src:a(553),alt:"IPv6配置"}})]),s._v(" "),n("li",[s._v("Aliddns 的"),n("code",[s._v("顶级域名3[IPv6]")]),s._v("配置上，会自动加上 AAAA 记录。")]),s._v(" "),n("li",[n("code",[s._v("自定义设置 - 脚本 - 在防火墙规则启动后执行:")]),s._v("里加上 IPv6 的防火墙策略")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 所需要的防火墙策略")]),s._v("\nip6tables -F\nip6tables -P INPUT ACCEPT\nip6tables -P FORWARD ACCEPT\nip6tables -P OUTPUT ACCEPT\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("ol",{attrs:{start:"4"}},[n("li",[s._v("在 frp 里配置上 IPv6 的节点。\n跟 IPv4 一样，需要注意的是，http/https 可以共用同一个端口，tcp 不能共用同一个端口，需要单独起一个端口供 IPv6 使用，同时端口转发里也加上这个端口。")])])])}),[],!1,null,null,null);t.default=e.exports}}]);