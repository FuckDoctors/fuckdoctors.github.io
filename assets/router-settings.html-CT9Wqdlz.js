import{_ as a,c as t,b as i,d as n,a as e,o as l}from"./app-BSrWI6e9.js";const p="/assets/http-https-ssh-C7wyiDT7.png",h="/assets/ipv6-settings-CSG3T0g4.png",k={};function r(d,s){return l(),t("div",null,[s[0]||(s[0]=i("h1",{id:"路由器折腾笔记",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#路由器折腾笔记"},[i("span",null,"路由器折腾笔记")])],-1)),s[1]||(s[1]=i("h2",{id:"刷机",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#刷机"},[i("span",null,"刷机")])],-1)),s[2]||(s[2]=i("p",null,"路由器型号为 newifi3-d2，咸鱼上『拣』的垃圾，当然不是免费的，为了 d2 版本挑拣的矿机。",-1)),s[3]||(s[3]=i("p",null,"到手后，刷了 breed，然后刷了 padavan，本人小白，所以选了 padavan。",-1)),n(" more "),s[4]||(s[4]=e('<p>之前很早的时候，newifi1 用过 openwrt，主要看中的是多拨，后来升级带宽，感觉够用了，而且感觉多拨也没怎么提升，padavan 功能整合的挺好就刷了 padavan，所以就一直沿用下来了。</p><p>（多拨没提升，估计是我网线的事，原来埋的是百兆线，padavan 上没多拨也是个遗憾吧）</p><h2 id="padavan-外网访问" tabindex="-1"><a class="header-anchor" href="#padavan-外网访问"><span>padavan 外网访问</span></a></h2><p>路由器刷了 padavan 后感觉功能很强大，但是基本没啥用，但是总想搞事情。</p><p>逛恩山论坛后，看到大家在刷翻墙，奈何自己没服务器，只能作罢。还看到大家在搞外网访问，虽然自己没啥用，但是感觉大家在搞，我也想搞搞，而且自己也正好有域名。</p><p>但是，之前买的 3 年的域名到期了，看着续费也不便宜（其实是穷。。。），自己不怎么用，所以就不续费了。新注册反而更便宜，那还是新注册个吧，反正之前的域名也没啥用。。。</p><p>鉴于上次买的域名时间短，这次想搞个时间长的，省得续费还贵，一次性搞了 10 年，对比了一下虽然腾讯域名比阿里域名便宜一点，但是鉴于腾讯的也不能用 Q 币（正好有闲置），而且之前阿里上的域名也都用过，所以还是选择了阿里。</p><p>上面废话了一通，这次回归正题，按以下几点实现外部访问。</p><ol><li><p>自己有域名后，可以配合 padavan 的<code>Aliddns</code>功能解析到域名下。</p><ul><li>配置阿里域名，获取 Access Key 的相关信息，使用<code>RAM 用户</code>，配置了<code>管理云解析（DNS）的权限</code>和<code>管理域名服务的权限</code>。</li><li>使用<code>Aliddns</code>配置。<a href="http://192.168.123.1/Advanced_Extensions_aliddns.asp" target="_blank" rel="noopener noreferrer">配置链接</a>：<code>http://192.168.123.1/Advanced_Extensions_aliddns.asp</code></li></ul></li><li><p>确保开启了路由的<code>HTTP Web 服务</code></p><ul><li><a href="http://192.168.123.1/Advanced_Services_Content.asp" target="_blank" rel="noopener noreferrer">配置链接</a>：<code>http://192.168.123.1/Advanced_Services_Content.asp</code></li><li>开启 HTTP &amp; HTTPS 服务，如下所示：<br><img src="'+p+`" alt="开启HTTP &amp; HTTPS" loading="lazy"></li><li>此处同时开启了 ssh 服务</li></ul></li><li><p>使用 frp 实现内网穿透</p><ul><li><a href="http://192.168.123.1/Advanced_Extensions_frp.asp" target="_blank" rel="noopener noreferrer">配置链接</a>：<code>http://192.168.123.1/Advanced_Extensions_frp.asp</code></li><li>配置脚本<code>frp_scripts</code><br> 为了简便，这里只说明修改部分。</li></ul><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ==========客户端配置：==========</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[common]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">server_addr</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 自己的域名</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">server_port</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 7000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">token</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 自己设置一个token，跟服务器端一致即可</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[web]</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">local_port</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 80</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 跟上面HTTP Web服务的的端口保持一致</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">remote_port</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 自己设置一个端口</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 这里注意一下，一般运营上会屏蔽80端口，使用其他端口。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">custom_domains</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 自己的域名</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[https]</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">local_port</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 443</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 跟上面HTTPS Web服务的的端口保持一致</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">remote_port</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https的端口</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 自己配置一个https的端口</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">custom_domains</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 自己的域名</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[ssh]</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tcp</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">local_port</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 22</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">remote_port</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ssh的端口</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ==========服务端配置：==========</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[common]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">bind_port</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 7000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dashboard_port</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 7500</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># dashboard 用户名密码，默认都为 admin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dashboard_user</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> admin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dashboard_pwd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> admin</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 通过自定义域名访问部署于内网的 web 服务</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># https://github.com/fatedier/frp/blob/master/README_zh.md#%E9%80%9A%E8%BF%87%E8%87%AA%E5%AE%9A%E4%B9%89%E5%9F%9F%E5%90%8D%E8%AE%BF%E9%97%AE%E9%83%A8%E7%BD%B2%E4%BA%8E%E5%86%85%E7%BD%91%E7%9A%84-web-%E6%9C%8D%E5%8A%A1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vhost_http_port</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 供外网访问的http端口，跟上面的http的remote_port保持一致</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vhost_https_port</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 供外网访问的https端口，跟上面的https的remote_port保持一致</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">token</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 跟客户端的token保持一致</span></span></code></pre></div><ul><li>特别说明 <ul><li>http 的<code>remote_port</code>遇到过一个坑，最初设置的 8080 能正常范围，后来不知啥时候不能访问了，一开始以为配置错了，各种调整依然不行，后来发现设为别的端口就可以，估计是 8080 也被运营商封掉了。。。</li><li>https 的 443 也被运行商封掉了，换用其他端口。</li></ul></li></ul></li><li><p>配置端口转发</p><ul><li>为了定制更多端口转发，我在<code>外部网络 (WAN) - 端口转发 (UPnP)</code>中自己设的</li><li>也可以在<code>防火墙 - 通用设置</code>中开启</li></ul></li><li><p>SSL 证书<br> 需要启用 https 的话，需要申请免费或购买收费证书，得到正数后，将证书内容填到下面两项内。</p><p>位置：<code>系统管理 - 服务</code></p><p>配置项：</p><ul><li>Server Certificate (required)</li><li>Server Private Key (required)</li></ul></li></ol><p>不出意外，就可以外网访问了，如有意外，先检查配置，再网络搜索。</p><h2 id="开启-ipv6-外网访问" tabindex="-1"><a class="header-anchor" href="#开启-ipv6-外网访问"><span>开启 IPv6 外网访问</span></a></h2><p>运营上已支持 IPv6，路由里也自动获得了 IPv6。</p><ol><li><p>默认配置：<br><img src="`+h+`" alt="IPv6配置" loading="lazy"></p></li><li><p>Aliddns 的<code>顶级域名3[IPv6]</code>配置上，会自动加上 AAAA 记录。</p></li><li><p><code>自定义设置 - 脚本 - 在防火墙规则启动后执行:</code>里加上 IPv6 的防火墙策略</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">### 所需要的防火墙策略</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ip6tables</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -F</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ip6tables</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -P</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> INPUT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ACCEPT</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ip6tables</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -P</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> FORWARD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ACCEPT</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ip6tables</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -P</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> OUTPUT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ACCEPT</span></span></code></pre></div></li><li><p>在 frp 里配置上 IPv6 的节点。<br> 跟 IPv4 一样，需要注意的是，http/https 可以共用同一个端口，tcp 不能共用同一个端口，需要单独起一个端口供 IPv6 使用，同时端口转发里也加上这个端口。</p></li></ol>`,13))])}const c=a(k,[["render",r]]),g=JSON.parse(`{"path":"/en/posts/router/router-settings.html","title":"路由器折腾笔记","lang":"en-US","frontmatter":{"article":true,"date":"2020-03-20T00:00:00.000Z","icon":"router","category":["router"],"tag":["wifi","n1","padavan"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"路由器折腾笔记\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2020-03-20T00:00:00.000Z\\",\\"dateModified\\":\\"2022-04-09T04:03:01.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Zhao Bin\\",\\"url\\":\\"zhaobc.site\\",\\"email\\":\\"hi@zhaobc.site\\"}]}"],["meta",{"property":"og:url","content":"https://www.zhaobc.site/en/posts/router/router-settings.html"}],["meta",{"property":"og:site_name","content":"ZhaoBin's site"}],["meta",{"property":"og:title","content":"路由器折腾笔记"}],["meta",{"property":"og:description","content":"刷机 路由器型号为 newifi3-d2，咸鱼上『拣』的垃圾，当然不是免费的，为了 d2 版本挑拣的矿机。 到手后，刷了 breed，然后刷了 padavan，本人小白，所以选了 padavan。"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:locale:alternate","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2022-04-09T04:03:01.000Z"}],["meta",{"property":"article:tag","content":"padavan"}],["meta",{"property":"article:tag","content":"n1"}],["meta",{"property":"article:tag","content":"wifi"}],["meta",{"property":"article:published_time","content":"2020-03-20T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2022-04-09T04:03:01.000Z"}],["link",{"rel":"alternate","hreflang":"zh-cn","href":"https://www.zhaobc.site/posts/router/router-settings.html"}],["meta",{"name":"description","content":"newifi3 路由器折腾笔记"}],["link",{"rel":"alternate","type":"application/rss+xml","href":"https://www.zhaobc.site/en/rss.xml","title":"ZhaoBin's site RSS Feed"}]],"description":"刷机 路由器型号为 newifi3-d2，咸鱼上『拣』的垃圾，当然不是免费的，为了 d2 版本挑拣的矿机。 到手后，刷了 breed，然后刷了 padavan，本人小白，所以选了 padavan。"},"git":{"createdTime":1648921112000,"updatedTime":1649476981000,"contributors":[{"name":"FuckDoctors","username":"FuckDoctors","email":"zhbchwin@163.com","commits":4,"url":"https://github.com/FuckDoctors"},{"name":"Zhao Bin","username":"","email":"zhbchwin@163.com","commits":1}]},"readingTime":{"minutes":4.41,"words":1324},"filePathRelative":"en/posts/router/router-settings.md","excerpt":"\\n<h2>刷机</h2>\\n<p>路由器型号为 newifi3-d2，咸鱼上『拣』的垃圾，当然不是免费的，为了 d2 版本挑拣的矿机。</p>\\n<p>到手后，刷了 breed，然后刷了 padavan，本人小白，所以选了 padavan。</p>\\n","autoDesc":true}`);export{c as comp,g as data};
