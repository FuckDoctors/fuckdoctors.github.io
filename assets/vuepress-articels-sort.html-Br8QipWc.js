import{_ as e,o as t,c as o,d as c}from"./app-BUWELqnD.js";const r={},s=c('<h1 id="vuepress-文章排序问题" tabindex="-1"><a class="header-anchor" href="#vuepress-文章排序问题"><span>VuePress 文章排序问题</span></a></h1><h2 id="现象" tabindex="-1"><a class="header-anchor" href="#现象"><span>现象</span></a></h2><p>开发模式下，文章排序没问题，CI（Github Actions/Vercel） 发布后文章排序不对，并且时间线也不对。</p><h2 id="调查" tabindex="-1"><a class="header-anchor" href="#调查"><span>调查</span></a></h2><p>查看 <code>vuepress-theme-hope</code> 后，发现默认按 <code>frontmatter.date</code> 和 git 创建时间排序。</p><p><code>posts</code> 下的文章都指定了 <code>date</code>，没有问题；而 <code>notes</code> 下的笔记都没有指定 <code>date</code>，想定按 git 创建日期显示，但是貌似按 git 最后更新时间，或者发布时间显示了。</p><p>从而推断是 CI 上的问题。</p><h2 id="对策" tabindex="-1"><a class="header-anchor" href="#对策"><span>对策</span></a></h2><p>由于本工程采用了两个 CI 同时发布，所以需要解决两条路。</p><ul><li>Github Action 发布 Github Pages</li><li>Vercel CI 发布到 Vercel</li></ul><h3 id="github-actions" tabindex="-1"><a class="header-anchor" href="#github-actions"><span>Github Actions</span></a></h3><p>查看 Github Actions 发现 <code>actions/checkout</code> 默认只取最后一次履历，指定 <code>fetch-depth: 0</code> 可以解决该问题。</p><h3 id="vercel" tabindex="-1"><a class="header-anchor" href="#vercel"><span>Vercel</span></a></h3><p>Vercel 控制面板上没有地方指定 <code>git clone</code> 相关内容，查阅文档后，发现 Vercel 默认执行 <code>git clone --depth=10 (...)</code>。</p><blockquote><p>During this time, Vercel performs a &quot;shallow clone&quot; on your Git repository using the command <code>git clone --depth=10 (...)</code> and fetches ten levels of git commit history. This means that only the latest ten commits are pulled and not the entire repository history.</p></blockquote><p>但是官方文档里没提到如何更改这个设置。。。</p><p>一番搜索后，发现了两种方案：</p><p><a href="https://github.com/vercel/vercel/discussions/5737" target="_blank" rel="noopener noreferrer">How to unshallow repo?</a></p><ol><li>使用 Github Action 的 <code>deploy-to-vercel-action</code> 发布到 Vercel</li><li>通过 Vercel 的环境变量 <code>VERCEL_DEEP_CLONE: true</code></li></ol><p>第一种感觉有点怪怪的感觉，第二种更简单也更符合我的需求，所以采用了第二种方案。</p>',20),a=[s];function i(n,l){return t(),o("div",null,a)}const d=e(r,[["render",i],["__file","vuepress-articels-sort.html.vue"]]),h=JSON.parse('{"path":"/posts/devops/vuepress-articels-sort.html","title":"VuePress 文章排序问题","lang":"zh-CN","frontmatter":{"article":true,"date":"2024-05-16T00:00:00.000Z","category":["devops","theme"],"tag":["devops","ci/cd"],"head":[["meta",{"name":"description","content":"VuePress 文章排序问题"}],["meta",{"property":"og:url","content":"https://www.zhaobc.site/posts/devops/vuepress-articels-sort.html"}],["meta",{"property":"og:site_name","content":"赵斌的小站"}],["meta",{"property":"og:title","content":"VuePress 文章排序问题"}],["meta",{"property":"og:description","content":"VuePress 文章排序问题 现象 开发模式下，文章排序没问题，CI（Github Actions/Vercel） 发布后文章排序不对，并且时间线也不对。 调查 查看 vuepress-theme-hope 后，发现默认按 frontmatter.date 和 git 创建时间排序。 posts 下的文章都指定了 date，没有问题；而 notes ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-05-16T03:18:25.000Z"}],["meta",{"property":"article:author","content":"Zhao Bin"}],["meta",{"property":"article:tag","content":"devops"}],["meta",{"property":"article:tag","content":"ci/cd"}],["meta",{"property":"article:published_time","content":"2024-05-16T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-05-16T03:18:25.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"VuePress 文章排序问题\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-05-16T00:00:00.000Z\\",\\"dateModified\\":\\"2024-05-16T03:18:25.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Zhao Bin\\",\\"url\\":\\"zhaobc.site\\",\\"email\\":\\"hi@zhaobc.site\\"}]}"]],"description":"VuePress 文章排序问题 现象 开发模式下，文章排序没问题，CI（Github Actions/Vercel） 发布后文章排序不对，并且时间线也不对。 调查 查看 vuepress-theme-hope 后，发现默认按 frontmatter.date 和 git 创建时间排序。 posts 下的文章都指定了 date，没有问题；而 notes ..."},"headers":[{"level":2,"title":"现象","slug":"现象","link":"#现象","children":[]},{"level":2,"title":"调查","slug":"调查","link":"#调查","children":[]},{"level":2,"title":"对策","slug":"对策","link":"#对策","children":[{"level":3,"title":"Github Actions","slug":"github-actions","link":"#github-actions","children":[]},{"level":3,"title":"Vercel","slug":"vercel","link":"#vercel","children":[]}]}],"git":{"createdTime":1715829334000,"updatedTime":1715829505000,"contributors":[{"name":"Zhao Bin","email":"413853119@qq.com","commits":1}]},"readingTime":{"minutes":1.33,"words":400},"filePathRelative":"posts/devops/vuepress-articels-sort.md","localizedDate":"2024年5月16日","excerpt":"\\n<h2>现象</h2>\\n<p>开发模式下，文章排序没问题，CI（Github Actions/Vercel） 发布后文章排序不对，并且时间线也不对。</p>\\n<h2>调查</h2>\\n<p>查看 <code>vuepress-theme-hope</code> 后，发现默认按 <code>frontmatter.date</code> 和 git 创建时间排序。</p>\\n<p><code>posts</code> 下的文章都指定了 <code>date</code>，没有问题；而 <code>notes</code> 下的笔记都没有指定 <code>date</code>，想定按 git 创建日期显示，但是貌似按 git 最后更新时间，或者发布时间显示了。</p>","autoDesc":true}');export{d as comp,h as data};
