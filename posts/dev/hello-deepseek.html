<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.24" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.94" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"DeepSeek åˆä½“éªŒ","image":[""],"datePublished":"2025-02-06T00:00:00.000Z","dateModified":"2025-03-11T03:58:39.000Z","author":[{"@type":"Person","name":"Zhao Bin","url":"zhaobc.site","email":"hi@zhaobc.site"}]}</script><meta property="og:url" content="https://www.zhaobc.site/posts/dev/hello-deepseek.html"><meta property="og:site_name" content="èµµæ–Œçš„å°ç«™"><meta property="og:title" content="DeepSeek åˆä½“éªŒ"><meta property="og:description" content="DeepSeek åˆä½“éªŒ æ˜¥èŠ‚æœŸé—´ï¼ŒDeepSeek çœŸæ˜¯å¤§ç«ï¼Œæ‰‹å¤´æ­£å¥½æœ‰ä¸ªéœ€æ±‚ï¼Œæˆ‘å°±ä½“éªŒäº†ä¸€ä¸‹ã€‚ å®ƒçœŸçš„æ˜¯å¾ˆå¼ºå¤§ã€‚ è¿™é‡Œä»…æ˜¯ç®€å•è®°å½•ä¸€ä¸‹ï¼Œå®ƒç”Ÿæˆçš„ä»£ç ï¼Œæ›´å¤šå…³äº DeepSeek çš„ä½¿ç”¨ï¼Œå¤§å®¶å¯ä»¥å»å®˜ç½‘æŸ¥çœ‹ã€‚ éœ€æ±‚ æˆ‘éœ€è¦ä¸€ä¸ªåˆ†å‰² DOM æ ‘çš„åŠŸèƒ½ï¼Œæ ¹æ®æŒ‡å®šçš„èŠ‚ç‚¹ï¼Œå°† DOM æ ‘åˆ†å‰²æˆä¸¤ä¸ª DOM æ ‘ã€‚ ä¸€å¼€å§‹è¯•äº†å‡ ä¸ª DeepSeek å’Œ è±†åŒ… A..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-03-11T03:58:39.000Z"><meta property="article:tag" content="å¼€å‘"><meta property="article:tag" content="dev"><meta property="article:published_time" content="2025-02-06T00:00:00.000Z"><meta property="article:modified_time" content="2025-03-11T03:58:39.000Z"><meta name="description" content="DeepSeek åˆä½“éªŒ"><link rel="alternate" type="application/rss+xml" href="https://www.zhaobc.site/rss.xml" title="èµµæ–Œçš„å°ç«™ RSS Feed"><link rel="stylesheet" href="//at.alicdn.com/t/font_2410206_mfj6e1vbwo.css"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_4647860_t3wvzckeetc.css"><script src="//hm.baidu.com/hm.js?85e80625eddf91d81d9535565850722b"></script><script src="/assets/js/clarity.js"></script><meta name="mobile-web-app-capable" content="yes"><meta name="theme-color" content="#46bd87"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/favicon.ico"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><link rel="icon" href="/assets/icon/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icon/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icon/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icon/chrome-192.png" type="image/png" sizes="192x192"><link rel="apple-touch-icon" href="/assets/icon/apple-icon-152.png"><title>DeepSeek åˆä½“éªŒ | èµµæ–Œçš„å°ç«™</title>
    <link rel="preload" href="/assets/style-BaaKZ5Ld.css" as="style"><link rel="stylesheet" href="/assets/style-BaaKZ5Ld.css">
    <link rel="modulepreload" href="/assets/app-DwlqzNfg.js"><link rel="modulepreload" href="/assets/hello-deepseek.html-D8Y_wPd5.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container no-sidebar external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/" aria-label="å¸¦æˆ‘å›å®¶"><img class="vp-nav-logo" src="/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">èµµæ–Œçš„å°ç«™</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="ä¸»é¡µ"><!--[--><i class="vp-icon iconfont icon-home" sizing="height"></i><!--]-->ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/posts/" aria-label="åšå®¢"><!--[--><i class="vp-icon iconfont icon-blog" sizing="height"></i><!--]-->åšå®¢<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="ç¬”è®°"><!--[--><i class="vp-icon iconfont icon-note" sizing="height"></i>ç¬”è®°<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/notes/" aria-label="ç¬”è®°"><!--[--><i class="vp-icon iconfont icon-note" sizing="both"></i><!--]-->ç¬”è®°<!----></a></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">å‰ç«¯</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/notes/frontend/js/" aria-label="JavaScript"><!---->JavaScript<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/notes/frontend/ts/" aria-label="TypeScript"><!---->TypeScript<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/notes/frontend/vue/" aria-label="Vue"><!---->Vue<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/notes/frontend/vue/pinia/" aria-label="Pinia"><!---->Pinia<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/notes/frontend/" aria-label="æ›´å¤š"><!---->æ›´å¤š<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">åç«¯</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/notes/backend/java/" aria-label="Java"><!---->Java<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/notes/backend/spring/" aria-label="Spring"><!---->Spring<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/notes/backend/python/" aria-label="Python"><!---->Python<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/notes/backend/" aria-label="æ›´å¤š"><!---->æ›´å¤š<!----></a></li></ul></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/notes/other/" aria-label="å…¶ä»–"><!---->å…¶ä»–<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="åˆ†ç±»"><!--[--><i class="vp-icon iconfont icon-type" sizing="height"></i>åˆ†ç±»<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/category/" aria-label="åˆ†ç±»"><!--[--><i class="vp-icon iconfont icon-categoryselected" sizing="both"></i><!--]-->åˆ†ç±»<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/tag/" aria-label="æ ‡ç­¾"><!--[--><i class="vp-icon iconfont icon-tag" sizing="both"></i><!--]-->æ ‡ç­¾<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/timeline/" aria-label="æ—¶é—´çº¿"><!--[--><i class="vp-icon iconfont icon-flow" sizing="both"></i><!--]-->æ—¶é—´çº¿<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/projects.html" aria-label="é¡¹ç›®"><!--[--><i class="vp-icon iconfont icon-creative" sizing="height"></i><!--]-->é¡¹ç›®<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/links.html" aria-label="é“¾æ¥"><!--[--><i class="vp-icon iconfont icon-link" sizing="height"></i><!--]-->é“¾æ¥<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/about.html" aria-label="å…³äºæˆ‘"><!--[--><i class="vp-icon iconfont icon-people" sizing="height"></i><!--]-->å…³äºæˆ‘<!----></a></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><div class="vp-nav-item"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="é€‰æ‹©è¯­è¨€"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" name="i18n" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/posts/dev/hello-deepseek.html" aria-label="ç®€ä½“ä¸­æ–‡"><!---->ç®€ä½“ä¸­æ–‡<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/en/" aria-label="English"><!---->English<!----></a></li></ul></button></div></div><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/FuckDoctors/notes2" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-appearance-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-appearance-dropdown"><!----></div></button></div><div class="vp-nav-item vp-action hide-in-mobile"><div class="link-icon vp-action-link"><a class="link" href="https://play.zhaobc.site" target="_blank" rel="noopener noreferrer" aria-label="æ¼”ç»ƒåœº"><i class="vp-icon iconfont icon-console icon" sizing="height" style="color:var(--grey-dark);--icon-size:20px;"></i></a></div></div><!--[--><div id="docsearch-container" style="display:none;"></div><div><button type="button" class="DocSearch DocSearch-Button" aria-label="æœç´¢"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">æœç´¢</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><!----><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->DeepSeek åˆä½“éªŒ</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://www.zhaobc.site" target="_blank" rel="noopener noreferrer">Zhao Bin</a></span><span property="author" content="Zhao Bin"></span></span><!----><span class="page-pageview-info" aria-label="è®¿é—®é‡ğŸ”¢" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon eye-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="eye icon" name="eye"><path d="M992 512.096c0-5.76-.992-10.592-1.28-11.136-.192-2.88-1.152-8.064-2.08-10.816-.256-.672-.544-1.376-.832-2.08-.48-1.568-1.024-3.104-1.6-4.32C897.664 290.112 707.104 160 512 160c-195.072 0-385.632 130.016-473.76 322.592-1.056 2.112-1.792 4.096-2.272 5.856a55.512 55.512 0 00-.64 1.6c-1.76 5.088-1.792 8.64-1.632 7.744-.832 3.744-1.568 11.168-1.568 11.168-.224 2.272-.224 4.032.032 6.304 0 0 .736 6.464 1.088 7.808.128 1.824.576 4.512 1.12 6.976h-.032c.448 2.08 1.12 4.096 1.984 6.08.48 1.536.992 2.976 1.472 4.032C126.432 733.856 316.992 864 512 864c195.136 0 385.696-130.048 473.216-321.696 1.376-2.496 2.24-4.832 2.848-6.912.256-.608.48-1.184.672-1.728 1.536-4.48 1.856-8.32 1.728-8.32l-.032.032c.608-3.104 1.568-7.744 1.568-13.28zM512 672c-88.224 0-160-71.776-160-160s71.776-160 160-160 160 71.776 160 160-71.776 160-160 160z"></path></svg><span id="ArtalkPV" class="vp-pageview waline-pageview-count" data-path="/posts/dev/hello-deepseek.html" data-page-key="/posts/dev/hello-deepseek.html">...</span></span><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2025/2/6</span><meta property="datePublished" content="2025-02-06T00:00:00.000Z"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color3 clickable" role="navigation">dev</span><!--]--><meta property="articleSection" content="dev"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color3 clickable" role="navigation">dev</span><span class="page-tag-item color5 clickable" role="navigation">å¼€å‘</span><!--]--><meta property="keywords" content="dev,å¼€å‘"></span><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 22 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT22M"></span></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><h1 id="deepseek-åˆä½“éªŒ" tabindex="-1"><a class="header-anchor" href="#deepseek-åˆä½“éªŒ"><span>DeepSeek åˆä½“éªŒ</span></a></h1><p>æ˜¥èŠ‚æœŸé—´ï¼ŒDeepSeek çœŸæ˜¯å¤§ç«ï¼Œæ‰‹å¤´æ­£å¥½æœ‰ä¸ªéœ€æ±‚ï¼Œæˆ‘å°±ä½“éªŒäº†ä¸€ä¸‹ã€‚<br><strong>å®ƒçœŸçš„æ˜¯å¾ˆå¼ºå¤§</strong>ã€‚</p><p>è¿™é‡Œä»…æ˜¯ç®€å•è®°å½•ä¸€ä¸‹ï¼Œå®ƒç”Ÿæˆçš„ä»£ç ï¼Œæ›´å¤šå…³äº DeepSeek çš„ä½¿ç”¨ï¼Œå¤§å®¶å¯ä»¥å»å®˜ç½‘æŸ¥çœ‹ã€‚</p><h2 id="éœ€æ±‚" tabindex="-1"><a class="header-anchor" href="#éœ€æ±‚"><span>éœ€æ±‚</span></a></h2><p>æˆ‘éœ€è¦ä¸€ä¸ªåˆ†å‰² DOM æ ‘çš„åŠŸèƒ½ï¼Œæ ¹æ®æŒ‡å®šçš„èŠ‚ç‚¹ï¼Œå°† DOM æ ‘åˆ†å‰²æˆä¸¤ä¸ª DOM æ ‘ã€‚<br> ä¸€å¼€å§‹è¯•äº†å‡ ä¸ª DeepSeek å’Œ è±†åŒ… AIï¼Œéƒ½æ²¡è¾¾åˆ°æƒ³è¦çš„æ•ˆæœã€‚</p><p>éšåï¼Œé‡æ–°æäº†è‡ªå·±çš„éœ€æ±‚ï¼Œå°†éœ€æ±‚æ›´æ˜ç¡®åŒ–ä¹‹åï¼Œè¯•äº†ä¸€ä¸‹ DeepSeekï¼Œå®ƒç»è¿‡ 5 åˆ†é’Ÿçš„æ¨ç†ä¹‹åï¼Œç»™å‡ºäº†ä¸€ä¸ªéå¸¸ä¸é”™çš„ç­”æ¡ˆã€‚</p><p>éœ€æ±‚æè¿°å¦‚ä¸‹ï¼š</p><blockquote><p>å¸®æˆ‘ç”¨javascriptå†™ä¸€æ®µæŒ‰æŒ‡å®šèŠ‚ç‚¹åˆ†å‰²domæ ‘çš„ä»£ç ï¼Œåˆ†å‰²åçš„domæ ‘ä¾æ—§å†…å®¹å®Œæ•´ã€‚domæ ‘å¯ä»¥æ˜¯å¤šå±‚åµŒå¥—çš„ã€‚æŒ‡å®šèŠ‚ç‚¹ä¹‹å‰çš„domæ ‘å†…å®¹åˆ°è¯¥èŠ‚ç‚¹ç»“æŸï¼Œè‡ªåŠ¨è¡¥å…¨å‰©ä½™çš„domæ ‘ç»“æŸç¬¦ã€‚æŒ‡å®šèŠ‚ç‚¹ä¹‹åçš„domæ ‘å†…å®¹ä»¥è¯¥èŠ‚ç‚¹å¼€å§‹ï¼Œè‡ªåŠ¨è¡¥å…¨ä¹‹å‰çš„domæ ‘å¼€å§‹ç¬¦ã€‚</p></blockquote><h2 id="ç”Ÿæˆç»“æœ" tabindex="-1"><a class="header-anchor" href="#ç”Ÿæˆç»“æœ"><span>ç”Ÿæˆç»“æœ</span></a></h2><p>ä»¥ä¸‹æ˜¯å®ç°æŒ‰æŒ‡å®šèŠ‚ç‚¹åˆ†å‰²DOMæ ‘çš„JavaScriptä»£ç ï¼Œè¿”å›åˆ†å‰²åçš„ä¸¤ä¸ªå®Œæ•´DOMç»“æ„ï¼š</p><p>æ³¨ï¼šåŸæ¥æ˜¯ä»¥æ•´ä¸ª document æ¥å¤„ç†çš„ï¼Œç¨å¾®æ”¹äº†ä¸€ä¸‹ï¼Œæ¥å—æŒ‡å®šçš„ rootã€‚</p><div class="language-javascript" data-highlighter="shiki" data-ext="javascript" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-javascript"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// function splitDOMAtNode(originalNode) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> splitDOMAtNode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">originalNode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // æ·±å…‹éš†æ•´ä¸ªDOMæ ‘å¹¶å»ºç«‹åŸå§‹èŠ‚ç‚¹æ˜ å°„</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  function</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> cloneTreeWithMap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;"> nodeMap</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Map</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    function</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> clone</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">node</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">      const</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;"> cloned</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> node</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cloneNode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">      nodeMap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">set</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">node</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">cloned</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">      Array</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">node</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">childNodes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">child</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> =&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">        cloned</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">appendChild</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">clone</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">child</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      })</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">      return</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> cloned</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">clonedTree</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> clone</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">nodeMap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // ä¿®å‰ªåç»­å…„å¼ŸèŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  function</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> pruneSiblingsAfter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">node</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    let</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> current</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> node</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    while</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">current</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">parentNode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">      const</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;"> parent</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> current</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">parentNode</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">      const</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;"> siblings</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> Array</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">parent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">childNodes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">      const</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;"> idx</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> siblings</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">indexOf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">current</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      // ç§»é™¤å½“å‰èŠ‚ç‚¹ä¹‹åçš„æ‰€æœ‰èŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">      for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> siblings</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> &gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> idx</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">--</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">        parent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">removeChild</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">siblings</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">      current</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> parent</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // ä¿®å‰ªå‰ç½®å…„å¼ŸèŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  function</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> pruneSiblingsBefore</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">node</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    let</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> current</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> node</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    while</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">current</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">parentNode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">      const</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;"> parent</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> current</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">parentNode</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">      const</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;"> siblings</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> Array</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">parent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">childNodes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">      const</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;"> idx</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> siblings</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">indexOf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">current</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      // ç§»é™¤å½“å‰èŠ‚ç‚¹ä¹‹å‰çš„æ‰€æœ‰èŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">      for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> &lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> idx</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">        parent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">removeChild</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">siblings</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">      current</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> parent</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // // è·å–æ–‡æ¡£æ ¹èŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // const docRoot = originalNode.ownerDocument.documentElement;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // å¤„ç†å‰åŠéƒ¨åˆ†</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // const front = cloneTreeWithMap(docRoot);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;"> front</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> cloneTreeWithMap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;"> frontNode</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> front</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">nodeMap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">originalNode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  pruneSiblingsAfter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">frontNode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // å¤„ç†ååŠéƒ¨åˆ†</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // const back = cloneTreeWithMap(docRoot);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;"> back</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> cloneTreeWithMap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;"> backNode</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> back</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">nodeMap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">originalNode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  pruneSiblingsBefore</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">backNode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    frontFragment</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> front</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">clonedTree</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    backFragment</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> back</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">clonedTree</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// ä½¿ç”¨ç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;"> targetNode</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> document</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getElementById</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;split-target&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;">frontFragment</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;">backFragment</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> splitDOMAtNode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">targetNode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// è·å–HTMLå­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;å‰åŠéƒ¨åˆ†ï¼š</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">frontFragment</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">outerHTML</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;ååŠéƒ¨åˆ†ï¼š</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">backFragment</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">outerHTML</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre></div><h3 id="å®ç°åŸç†" tabindex="-1"><a class="header-anchor" href="#å®ç°åŸç†"><span>å®ç°åŸç†</span></a></h3><ol><li><strong>æ·±åº¦å…‹éš†</strong>ï¼šä½¿ç”¨é€’å½’æ–¹å¼å…‹éš†æ•´ä¸ªDOMæ ‘ï¼Œå¹¶å»ºç«‹åŸå§‹èŠ‚ç‚¹åˆ°å…‹éš†èŠ‚ç‚¹çš„æ˜ å°„å…³ç³»</li><li><strong>èŠ‚ç‚¹ä¿®å‰ª</strong>ï¼š <ul><li>å‰åŠéƒ¨åˆ†ï¼šä»ç›®æ ‡èŠ‚ç‚¹å‘ä¸Šéå†ï¼Œé€å±‚ç§»é™¤å½“å‰èŠ‚ç‚¹ä¹‹åçš„æ‰€æœ‰å…„å¼ŸèŠ‚ç‚¹</li><li>ååŠéƒ¨åˆ†ï¼šä»ç›®æ ‡èŠ‚ç‚¹å‘ä¸Šéå†ï¼Œé€å±‚ç§»é™¤å½“å‰èŠ‚ç‚¹ä¹‹å‰çš„æ‰€æœ‰å…„å¼ŸèŠ‚ç‚¹</li></ul></li><li><strong>ä¿æŒç»“æ„å®Œæ•´</strong>ï¼šé€šè¿‡é€å±‚å¤„ç†çˆ¶èŠ‚ç‚¹ï¼Œç¡®ä¿ç”Ÿæˆçš„DOMç‰‡æ®µä¿æŒå®Œæ•´çš„æ ‘å½¢ç»“æ„</li></ol><h3 id="ä½¿ç”¨è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨è¯´æ˜"><span>ä½¿ç”¨è¯´æ˜</span></a></h3><ol><li>ä¼ å…¥éœ€è¦åˆ†å‰²çš„ç›®æ ‡èŠ‚ç‚¹</li><li>è¿”å›åŒ…å«ä¸¤ä¸ªå±æ€§çš„å¯¹è±¡ï¼š <ul><li><code>frontFragment</code>ï¼šåŒ…å«ç›®æ ‡èŠ‚ç‚¹åŠå…¶ä¹‹å‰å†…å®¹çš„æ–°DOMæ ‘</li><li><code>backFragment</code>ï¼šåŒ…å«ç›®æ ‡èŠ‚ç‚¹åŠå…¶ä¹‹åå†…å®¹çš„æ–°DOMæ ‘</li></ul></li><li>å¯é€šè¿‡<code>outerHTML</code>å±æ€§è·å–å®Œæ•´HTMLå­—ç¬¦ä¸²</li></ol><h3 id="ç‰¹ç‚¹" tabindex="-1"><a class="header-anchor" href="#ç‰¹ç‚¹"><span>ç‰¹ç‚¹</span></a></h3><ul><li>ä¿æŒåŸå§‹DOMç»“æ„å®Œæ•´æ€§</li><li>è‡ªåŠ¨å¤„ç†å¤šå±‚åµŒå¥—ç»“æ„</li><li>ä¸ä¿®æ”¹åŸå§‹DOMæ ‘</li><li>è¿”å›æ ‡å‡†DOMèŠ‚ç‚¹ï¼Œå¯ç›´æ¥æ’å…¥æ–‡æ¡£</li></ul><blockquote><p>æ³¨æ„ï¼šè¯¥æ–¹æ³•ä¼šå…‹éš†æ•´ä¸ªæ–‡æ¡£ï¼Œé€‚ç”¨äºä¸­å°å‹é¡µé¢ã€‚å¯¹äºè¶…å¤§DOMç»“æ„å»ºè®®æŒ‡å®šå­æ ‘è¿›è¡Œå…‹éš†ä»¥æå‡æ€§èƒ½ã€‚</p></blockquote><h2 id="æ¨ç†è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#æ¨ç†è¿‡ç¨‹"><span>æ¨ç†è¿‡ç¨‹</span></a></h2><p>ç”±äºæ¨ç†è¿‡ç¨‹è¾ƒé•¿ï¼Œå°†å…¶æŠ˜å èµ·æ¥ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥æŸ¥çœ‹ã€‚</p><details class="hint-container details"><summary>ç‚¹å‡»æŸ¥çœ‹æ¨ç†è¿‡ç¨‹</summary><div class="language-txt" data-highlighter="shiki" data-ext="txt" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-txt"><span class="line"><span>å¥½çš„ï¼Œæˆ‘ç°åœ¨éœ€è¦å¸®ç”¨æˆ·å†™ä¸€æ®µJavaScriptä»£ç ï¼ŒæŒ‰æŒ‡å®šèŠ‚ç‚¹åˆ†å‰²DOMæ ‘ï¼Œåˆ†å‰²åçš„ä¸¤éƒ¨åˆ†è¦ä¿æŒå†…å®¹å®Œæ•´ã€‚è¿™ä¸ªé—®é¢˜çœ‹èµ·æ¥æœ‰ç‚¹æŒ‘æˆ˜æ€§ï¼Œæˆ‘éœ€è¦ä»”ç»†åˆ†æç”¨æˆ·çš„éœ€æ±‚ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>é¦–å…ˆï¼Œç”¨æˆ·å¸Œæœ›å°†ä¸€ä¸ªDOMæ ‘åœ¨æŒ‡å®šèŠ‚ç‚¹å¤„åˆ†å‰²æˆä¸¤éƒ¨åˆ†ã€‚åˆ†å‰²åçš„å‰éƒ¨åˆ†åº”è¯¥åŒ…å«æŒ‡å®šèŠ‚ç‚¹ä¹‹å‰çš„æ‰€æœ‰å†…å®¹ï¼Œå¹¶ä¸”åœ¨è¯¥èŠ‚ç‚¹ç»“æŸï¼Œè‡ªåŠ¨è¡¥å…¨å‰©ä¸‹çš„ç»“æŸæ ‡ç­¾ã€‚åéƒ¨åˆ†åˆ™æ˜¯ä»æŒ‡å®šèŠ‚ç‚¹å¼€å§‹ï¼Œè¡¥å…¨ä¹‹å‰çš„å¼€å§‹æ ‡ç­¾ã€‚è¿™å¬èµ·æ¥åƒæ˜¯è¦ç”Ÿæˆä¸¤ä¸ªæ–°çš„HTMLç‰‡æ®µï¼Œæ¯ä¸ªç‰‡æ®µåœ¨ç»“æ„ä¸Šéƒ½æ˜¯å®Œæ•´çš„ï¼Œä½†åˆ†åˆ«ä»¥æŒ‡å®šèŠ‚ç‚¹ä¸ºç»“å°¾å’Œå¼€å¤´ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>æ¥ä¸‹æ¥ï¼Œæˆ‘éœ€è¦ç†è§£å¦‚ä½•å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚å¯èƒ½éœ€è¦éå†DOMæ ‘ï¼Œåˆ†åˆ«å¤„ç†åˆ†å‰²ç‚¹ä¹‹å‰å’Œä¹‹åçš„èŠ‚ç‚¹ã€‚å¯¹äºå‰éƒ¨åˆ†ï¼Œéœ€è¦ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œä¸€ç›´åˆ°æŒ‡å®šèŠ‚ç‚¹ï¼Œç„¶åç¡®ä¿æ‰€æœ‰æœªé—­åˆçš„æ ‡ç­¾éƒ½è¢«æ­£ç¡®é—­åˆã€‚å¯¹äºåéƒ¨åˆ†ï¼Œå¯èƒ½éœ€è¦ä»æŒ‡å®šèŠ‚ç‚¹å¼€å§‹ï¼Œå‘ä¸Šè¡¥å…¨æ‰€æœ‰çˆ¶èŠ‚ç‚¹çš„å¼€å§‹æ ‡ç­¾ï¼Œä½¿å¾—è¿™ä¸ªç‰‡æ®µå¯ä»¥ç‹¬ç«‹å­˜åœ¨ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>é¦–å…ˆï¼Œå¤„ç†å‰éƒ¨åˆ†ã€‚å½“åˆ†å‰²ç‚¹åœ¨æŸä¸ªèŠ‚ç‚¹æ—¶ï¼Œå‰éƒ¨åˆ†éœ€è¦åŒ…å«è¯¥èŠ‚ç‚¹åŠå…¶ä¹‹å‰çš„æ‰€æœ‰å…„å¼ŸèŠ‚ç‚¹ï¼ŒåŒæ—¶ä¿è¯çˆ¶èŠ‚ç‚¹çš„ç»“æ„å®Œæ•´ã€‚æ¯”å¦‚ï¼Œå¦‚æœæŒ‡å®šèŠ‚ç‚¹æ˜¯æŸä¸ªdivçš„ç¬¬ä¸‰ä¸ªå­èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå‰éƒ¨åˆ†åº”è¯¥åŒ…å«è¯¥divçš„å‰ä¸‰ä¸ªå­èŠ‚ç‚¹ï¼Œå¹¶ä¸”é—­åˆè¯¥divä»¥åŠæ‰€æœ‰ç¥–å…ˆèŠ‚ç‚¹ã€‚ä½†ç”¨æˆ·å¯èƒ½å¸Œæœ›å‰éƒ¨åˆ†åœ¨æŒ‡å®šèŠ‚ç‚¹å¤„ç»“æŸï¼Œæ‰€ä»¥å¯èƒ½éœ€è¦å…‹éš†æŒ‡å®šèŠ‚ç‚¹åŠå…¶ä¹‹å‰çš„å…„å¼ŸèŠ‚ç‚¹ï¼Œç„¶åè¡¥å…¨æ‰€æœ‰æœªé—­åˆçš„æ ‡ç­¾ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ç„¶åæ˜¯åéƒ¨åˆ†ï¼Œéœ€è¦åŒ…å«æŒ‡å®šèŠ‚ç‚¹åŠå…¶ä¹‹åçš„å…„å¼ŸèŠ‚ç‚¹ï¼ŒåŒæ—¶è¡¥å…¨çˆ¶èŠ‚ç‚¹çš„å¼€å§‹æ ‡ç­¾ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæŒ‡å®šèŠ‚ç‚¹åœ¨æŸä¸ªdivä¸­ï¼Œé‚£ä¹ˆåéƒ¨åˆ†çš„divåº”è¯¥ä»è¯¥èŠ‚ç‚¹å¼€å§‹ï¼ŒåŒæ—¶å‰é¢çš„çˆ¶èŠ‚ç‚¹ç»“æ„éœ€è¦è¡¥å…¨ï¼Œä½†å¯èƒ½åªéœ€è¦ä»è¯¥èŠ‚ç‚¹æ‰€åœ¨å±‚çº§å¾€ä¸Šè¡¥å…¨ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä½†æ˜¯ï¼Œç›´æ¥æ“ä½œDOMæ ‘å¯èƒ½ä¼šæœ‰é—®é¢˜ï¼Œå› ä¸ºDOMæ˜¯åŠ¨æ€çš„ï¼Œä¿®æ”¹ä¼šå½±å“é¡µé¢ã€‚æ‰€ä»¥å¯èƒ½éœ€è¦å…ˆå…‹éš†èŠ‚ç‚¹ï¼Œç„¶ååœ¨å‰¯æœ¬ä¸Šè¿›è¡Œæ“ä½œï¼Œé¿å…å½±å“å®é™…é¡µé¢ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>å¯èƒ½çš„æ­¥éª¤æ˜¯ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>1. æ‰¾åˆ°æŒ‡å®šèŠ‚ç‚¹ï¼Œè·å–å…¶çˆ¶èŠ‚ç‚¹å’Œæ‰€æœ‰å…„å¼ŸèŠ‚ç‚¹ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>2. åˆ†å‰²å…„å¼ŸèŠ‚ç‚¹ä¸ºå‰éƒ¨åˆ†ï¼ˆç›´åˆ°æŒ‡å®šèŠ‚ç‚¹ï¼‰å’Œåéƒ¨åˆ†ï¼ˆä»æŒ‡å®šèŠ‚ç‚¹å¼€å§‹ï¼‰ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>3. å¯¹äºå‰éƒ¨åˆ†ï¼Œå…‹éš†çˆ¶èŠ‚ç‚¹ï¼Œå°†å‰éƒ¨åˆ†å…„å¼ŸèŠ‚ç‚¹æ·»åŠ åˆ°å…‹éš†çš„çˆ¶èŠ‚ç‚¹ä¸­ï¼Œç„¶åé€’å½’å¤„ç†æ‰€æœ‰ç¥–å…ˆèŠ‚ç‚¹ï¼Œç¡®ä¿ç»“æ„å®Œæ•´ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>4. å¯¹äºåéƒ¨åˆ†ï¼ŒåŒæ ·å…‹éš†çˆ¶èŠ‚ç‚¹ï¼Œå°†åéƒ¨åˆ†å…„å¼ŸèŠ‚ç‚¹æ·»åŠ è¿›å»ï¼Œç„¶åè¡¥å…¨çˆ¶èŠ‚ç‚¹çš„ç»“æ„ï¼Œå¯èƒ½éœ€è¦å‘ä¸Šæ„å»ºçˆ¶èŠ‚ç‚¹çš„å¼€å§‹éƒ¨åˆ†ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä¸è¿‡ï¼Œå¦‚ä½•è‡ªåŠ¨è¡¥å…¨å¼€å§‹å’Œç»“æŸæ ‡ç­¾å‘¢ï¼Ÿå¯èƒ½éœ€è¦ä»æŒ‡å®šèŠ‚ç‚¹å‘ä¸Šéå†ï¼Œå…‹éš†çˆ¶èŠ‚ç‚¹ç»“æ„ï¼Œä½†åªä¿ç•™å¿…è¦çš„å­èŠ‚ç‚¹ã€‚ä¾‹å¦‚ï¼Œå‰éƒ¨åˆ†éœ€è¦çˆ¶èŠ‚ç‚¹ç»“æ„ï¼Œä½†åªåŒ…å«åˆ°æŒ‡å®šèŠ‚ç‚¹ä¸ºæ­¢ï¼Œå¹¶ç¡®ä¿æ¯ä¸ªçˆ¶èŠ‚ç‚¹éƒ½è¢«æ­£ç¡®é—­åˆã€‚åéƒ¨åˆ†éœ€è¦çˆ¶èŠ‚ç‚¹ç»“æ„ï¼Œä½†åªåŒ…å«ä»æŒ‡å®šèŠ‚ç‚¹å¼€å§‹çš„éƒ¨åˆ†ï¼Œå¹¶åœ¨å‰é¢è¡¥å…¨çˆ¶èŠ‚ç‚¹çš„å¼€å§‹æ ‡ç­¾ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>æˆ–è€…ï¼Œå¯ä»¥è€ƒè™‘ç”ŸæˆHTMLå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯æ“ä½œå®é™…çš„DOMèŠ‚ç‚¹ã€‚è¿™æ ·å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²æ“ä½œæ¥è¡¥å…¨æ ‡ç­¾ã€‚ä¾‹å¦‚ï¼Œå¯¹äºå‰éƒ¨åˆ†ï¼Œéå†ä»æ ¹åˆ°æŒ‡å®šèŠ‚ç‚¹çš„è·¯å¾„ï¼Œç”Ÿæˆå¼€å§‹æ ‡ç­¾ï¼Œç›´åˆ°æŒ‡å®šèŠ‚ç‚¹ï¼Œç„¶åç”Ÿæˆç»“æŸæ ‡ç­¾ã€‚ä½†è¿™æ ·å¯èƒ½ä¸å¤ªå‡†ç¡®ï¼Œå› ä¸ºDOMç»“æ„å¯èƒ½å¤æ‚ï¼ŒåµŒå¥—å±‚æ¬¡å¤šã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>æˆ–è€…ï¼Œå¯ä»¥åˆ†åˆ«æ„å»ºä¸¤ä¸ªæ–‡æ¡£ç‰‡æ®µï¼Œå‰ç‰‡æ®µåŒ…å«åˆ°æŒ‡å®šèŠ‚ç‚¹ä¸ºæ­¢çš„ç»“æ„ï¼Œåç‰‡æ®µåŒ…å«ä»æŒ‡å®šèŠ‚ç‚¹å¼€å§‹çš„ç»“æ„ï¼ŒåŒæ—¶è¡¥å…¨å¿…è¦çš„çˆ¶èŠ‚ç‚¹ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>å¯èƒ½éœ€è¦ä¸€ä¸ªå‡½æ•°æ¥å…‹éš†æŒ‡å®šèŠ‚ç‚¹åŠå…¶ç¥–å…ˆçš„ç»“æ„ï¼Œåªä¿ç•™å¿…è¦çš„å­èŠ‚ç‚¹ã€‚ä¾‹å¦‚ï¼Œå¯¹äºå‰éƒ¨åˆ†ï¼Œå…‹éš†æ¯ä¸ªç¥–å…ˆèŠ‚ç‚¹ï¼Œä½†åªä¿ç•™åˆ°æŒ‡å®šèŠ‚ç‚¹ä¸ºæ­¢çš„å…„å¼ŸèŠ‚ç‚¹ã€‚å¯¹äºåéƒ¨åˆ†ï¼Œå…‹éš†ç¥–å…ˆèŠ‚ç‚¹ï¼Œä½†åªä¿ç•™ä»æŒ‡å®šèŠ‚ç‚¹å¼€å§‹çš„å…„å¼ŸèŠ‚ç‚¹ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æŒ‡å®šèŠ‚ç‚¹æ˜¯æŸä¸ªdivä¸­çš„ç¬¬ä¸‰ä¸ªpæ ‡ç­¾ã€‚å‰éƒ¨åˆ†éœ€è¦ç”Ÿæˆä¸€ä¸ªåŒ…å«è¯¥divçš„å…‹éš†ï¼Œå…¶ä¸­åªæœ‰å‰ä¸‰ä¸ªpæ ‡ç­¾ï¼Œç„¶åé—­åˆè¯¥divåŠå…¶æ‰€æœ‰ç¥–å…ˆã€‚åéƒ¨åˆ†åˆ™ç”Ÿæˆä¸€ä¸ªåŒ…å«è¯¥divçš„å…‹éš†ï¼Œå…¶ä¸­ä»ç¬¬ä¸‰ä¸ªpå¼€å§‹ï¼ŒåŒæ—¶è¿™äº›å…‹éš†çš„divéœ€è¦è¢«åŒ…è£¹åœ¨ç¥–å…ˆèŠ‚ç‚¹çš„ç»“æ„ä¸­ï¼Œä½†ç¥–å…ˆçš„å¼€å§‹æ ‡ç­¾éœ€è¦å­˜åœ¨ï¼Œè€Œç»“æŸæ ‡ç­¾åœ¨é€‚å½“çš„ä½ç½®ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>è¿™ä¼¼ä¹éœ€è¦é€’å½’åœ°å¤„ç†æ¯ä¸ªçˆ¶èŠ‚ç‚¹ï¼Œå…‹éš†å®ƒä»¬ï¼Œå¹¶è°ƒæ•´å­èŠ‚ç‚¹åˆ—è¡¨ä¸ºåˆ†å‰²åçš„éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼Œå¯¹äºå‰éƒ¨åˆ†ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function cloneAncestors(node, includeSiblingsBefore) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>if (!node.parentNode) return null;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const parentClone = node.parentNode.cloneNode(false); // æµ…å…‹éš†ï¼Œä¸åŒ…å«å­èŠ‚ç‚¹</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const siblings = Array.from(node.parentNode.childNodes);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const index = siblings.indexOf(node);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const nodesToInclude = includeSiblingsBefore ? siblings.slice(0, index + 1) : siblings.slice(index);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>nodesToInclude.forEach(child =&gt; {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>if (child === node &amp;&amp; includeSiblingsBefore) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>parentClone.appendChild(child.cloneNode(true)); // å¯èƒ½éœ€è¦æ·±åº¦å…‹éš†ï¼Ÿ</span></span>
<span class="line"><span></span></span>
<span class="line"><span>} else {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// å¯¹äºå…¶ä»–å­èŠ‚ç‚¹ï¼Œå¯èƒ½éœ€è¦å…‹éš†å¹¶æ ¹æ®æƒ…å†µå¤„ç†</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// è¿™é‡Œå¯èƒ½éœ€è¦é€’å½’å¤„ç†ï¼Œå¦‚æœæ˜¯å‰éƒ¨åˆ†ï¼Œåªå…‹éš†å‰é¢çš„å…„å¼ŸèŠ‚ç‚¹</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// ä½†è¿™æ ·å¯èƒ½å˜å¾—å¤æ‚ï¼Œå› ä¸ºæ¯ä¸ªå­èŠ‚ç‚¹å¯èƒ½è¿˜æœ‰è‡ªå·±çš„å­èŠ‚ç‚¹</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>});</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const higherAncestor = cloneAncestors(node.parentNode, includeSiblingsBefore);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>if (higherAncestor) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>higherAncestor.appendChild(parentClone);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>} else {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>return parentClone;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>è¿™å¯èƒ½æ¯”è¾ƒå¤æ‚ï¼Œå› ä¸ºæ¯ä¸ªç¥–å…ˆèŠ‚ç‚¹éƒ½éœ€è¦è¢«å…‹éš†ï¼Œå¹¶ä¸”å…¶å­èŠ‚ç‚¹éœ€è¦è¢«è°ƒæ•´ä¸ºåˆ†å‰²åçš„éƒ¨åˆ†ã€‚æ¯”å¦‚ï¼Œçˆ¶èŠ‚ç‚¹å…‹éš†åï¼Œå­èŠ‚ç‚¹åªåŒ…æ‹¬åˆ°æŒ‡å®šèŠ‚ç‚¹ä¸ºæ­¢çš„å‰å…„å¼ŸèŠ‚ç‚¹ï¼Œæˆ–è€…ä»æŒ‡å®šèŠ‚ç‚¹å¼€å§‹çš„åå…„å¼ŸèŠ‚ç‚¹ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>æˆ–è€…ï¼Œå¯¹äºå‰éƒ¨åˆ†ï¼Œä»æŒ‡å®šèŠ‚ç‚¹å‘ä¸Šéå†ï¼Œæ¯ä¸ªçˆ¶èŠ‚ç‚¹å…‹éš†ä¸€ä¸ªå‰¯æœ¬ï¼Œè¯¥å‰¯æœ¬çš„å­èŠ‚ç‚¹åªåŒ…å«åˆ°æŒ‡å®šèŠ‚ç‚¹åŠå…¶ä¹‹å‰çš„å…„å¼ŸèŠ‚ç‚¹ã€‚ä¾‹å¦‚ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function buildFrontFragment(node) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>let current = node;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>let fragment = null;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>while (current.parentNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const parentClone = current.parentNode.cloneNode(false);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const siblings = Array.from(current.parentNode.childNodes);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const index = siblings.indexOf(current);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const precedingSiblings = siblings.slice(0, index + 1);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>precedingSiblings.forEach(sibling =&gt; {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>if (sibling === current) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>parentClone.appendChild(sibling.cloneNode(true));</span></span>
<span class="line"><span></span></span>
<span class="line"><span>} else {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>parentClone.appendChild(sibling.cloneNode(true)); // æˆ–è€…æ˜¯å¦éœ€è¦å¤„ç†åµŒå¥—ï¼Ÿ</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>});</span></span>
<span class="line"><span></span></span>
<span class="line"><span>if (fragment) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>parentClone.appendChild(fragment);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>fragment = parentClone;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>current = current.parentNode;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>return fragment;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>è¿™å¯èƒ½ç”Ÿæˆä¸€ä¸ªä»æ ¹åˆ°æŒ‡å®šèŠ‚ç‚¹çš„ç»“æ„ï¼Œå…¶ä¸­æ¯ä¸ªçˆ¶èŠ‚ç‚¹åªåŒ…å«åˆ°å½“å‰èŠ‚ç‚¹ä¸ºæ­¢çš„å­èŠ‚ç‚¹ã€‚ä½†è¿™æ ·çš„è¯ï¼Œå¯èƒ½ç»“æ„ä¼šè¢«æ­£ç¡®è¡¥å…¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåŸç»“æ„æ˜¯ body &gt; div &gt; pï¼ŒæŒ‡å®šèŠ‚ç‚¹æ˜¯pï¼Œé‚£ä¹ˆå‰éƒ¨åˆ†çš„fragmentä¼šæ˜¯bodyå…‹éš†ï¼ŒåŒ…å«divå…‹éš†ï¼Œdivå…‹éš†åŒ…å«på…‹éš†ã€‚è¿™æ ·ï¼Œå½“åºåˆ—åŒ–ä¸ºHTMLæ—¶ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆæ­£ç¡®çš„é—­åˆæ ‡ç­¾ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>åŒæ ·ï¼Œåéƒ¨åˆ†éœ€è¦ä»æŒ‡å®šèŠ‚ç‚¹å¼€å§‹ï¼Œå‘ä¸Šæ„å»ºçˆ¶èŠ‚ç‚¹ï¼Œæ¯ä¸ªçˆ¶èŠ‚ç‚¹å…‹éš†ååªåŒ…å«ä»æŒ‡å®šèŠ‚ç‚¹å¼€å§‹çš„å­èŠ‚ç‚¹ï¼Œå¹¶ä¸”è¿™äº›çˆ¶èŠ‚ç‚¹è¢«æ­£ç¡®åŒ…è£¹ã€‚ä¾‹å¦‚ï¼ŒåŒæ ·ä½¿ç”¨ç±»ä¼¼çš„æ–¹æ³•ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function buildBackFragment(node) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>let current = node;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>let fragment = null;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>while (current.parentNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const parentClone = current.parentNode.cloneNode(false);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const siblings = Array.from(current.parentNode.childNodes);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const index = siblings.indexOf(current);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const followingSiblings = siblings.slice(index);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>followingSiblings.forEach(sibling =&gt; {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>if (sibling === current) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>parentClone.appendChild(sibling.cloneNode(true));</span></span>
<span class="line"><span></span></span>
<span class="line"><span>} else {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>parentClone.appendChild(sibling.cloneNode(true));</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>});</span></span>
<span class="line"><span></span></span>
<span class="line"><span>if (fragment) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>parentClone.appendChild(fragment);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>fragment = parentClone;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>current = current.parentNode;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>return fragment;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>è¿™æ ·ï¼Œåéƒ¨åˆ†çš„fragmentä¼šåŒ…å«ä»æŒ‡å®šèŠ‚ç‚¹å¼€å§‹çš„æ‰€æœ‰åç»­å…„å¼ŸèŠ‚ç‚¹ï¼Œå¹¶ä¸”æ¯ä¸ªçˆ¶èŠ‚ç‚¹éƒ½è¢«å…‹éš†ï¼ŒåªåŒ…å«è¿™äº›å­èŠ‚ç‚¹ã€‚å½“åºåˆ—åŒ–ä¸ºHTMLæ—¶ï¼Œçˆ¶èŠ‚ç‚¹çš„å¼€å§‹æ ‡ç­¾ä¼šè¢«ä¿ç•™ï¼Œè€Œç»“æŸæ ‡ç­¾åœ¨æœ€åã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä½†è¿™æ ·ç”Ÿæˆçš„fragmentæ˜¯å¦æ­£ç¡®å‘¢ï¼Ÿä¾‹å¦‚ï¼ŒåŸç»“æ„æ˜¯ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;div&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;p&gt;1&lt;/p&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;p&gt;2&lt;/p&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;p id=&quot;target&quot;&gt;3&lt;/p&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;p&gt;4&lt;/p&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/div&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>å¦‚æœæŒ‡å®šèŠ‚ç‚¹æ˜¯idä¸ºtargetçš„pï¼Œå‰éƒ¨åˆ†åº”è¯¥ç”Ÿæˆï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;div&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;p&gt;1&lt;/p&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;p&gt;2&lt;/p&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;p id=&quot;target&quot;&gt;3&lt;/p&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/div&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>åéƒ¨åˆ†åº”è¯¥ç”Ÿæˆï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;div&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;p id=&quot;target&quot;&gt;3&lt;/p&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;p&gt;4&lt;/p&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/div&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä½†æŒ‰ç…§ä¸Šé¢çš„buildBackFragmentå‡½æ•°ï¼Œç”Ÿæˆçš„divå…‹éš†ä¼šåŒ…å«targetå’Œåç»­çš„pï¼Œä½†çˆ¶ç»“æ„å¯èƒ½æ›´é«˜å±‚çº§çš„èŠ‚ç‚¹ä¹Ÿè¢«å…‹éš†ã€‚ä¾‹å¦‚ï¼Œå¦‚æœdivåœ¨bodyä¸­ï¼Œé‚£ä¹ˆåéƒ¨åˆ†çš„fragmentä¼šæ˜¯bodyå…‹éš†åŒ…å«divå…‹éš†ï¼Œè€Œdivå…‹éš†åŒ…å«targetå’Œåç»­çš„pã€‚è¿™æ ·å½“åºåˆ—åŒ–æ—¶ï¼Œä¼šæœ‰å®Œæ•´çš„ç»“æ„ï¼Œä½†ç”¨æˆ·å¯èƒ½éœ€è¦åéƒ¨åˆ†ä»targetå¼€å§‹ï¼Œå³å¯èƒ½éœ€è¦divä»targetå¼€å§‹ï¼Œè€Œä¸æ˜¯æ•´ä¸ªbodyç»“æ„ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>å¯èƒ½ç”¨æˆ·å¸Œæœ›åˆ†å‰²åçš„ä¸¤ä¸ªéƒ¨åˆ†å„è‡ªéƒ½æ˜¯å®Œæ•´çš„HTMLç»“æ„ã€‚æ¯”å¦‚ï¼Œå‰éƒ¨åˆ†å¯èƒ½æ˜¯ä¸€ä¸ªå®Œæ•´çš„HTMLï¼ŒåŒ…å«åˆ°targetä¸ºæ­¢çš„æ‰€æœ‰å†…å®¹ï¼Œåéƒ¨åˆ†åˆ™æ˜¯å¦ä¸€ä¸ªå®Œæ•´HTMLï¼Œä»targetå¼€å§‹çš„å†…å®¹ã€‚ä½†è¿™å¯èƒ½ä¸å¤ªç°å®ï¼Œå› ä¸ºä¸€ä¸ªHTMLåªèƒ½æœ‰ä¸€ä¸ªhtmlæ ¹å…ƒç´ ã€‚æˆ–è€…ç”¨æˆ·å¯èƒ½å¸Œæœ›å¾—åˆ°ä¸¤ä¸ªDOMç‰‡æ®µï¼Œæ¯ä¸ªç‰‡æ®µåœ¨ç»“æ„ä¸Šæ˜¯è‡ªæ´½çš„ï¼Œå¯ä»¥ç‹¬ç«‹å­˜åœ¨ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>æˆ–è€…ï¼Œç”¨æˆ·å¯èƒ½å¸Œæœ›åˆ†å‰²åçš„ä¸¤ä¸ªéƒ¨åˆ†åœ¨DOMç»“æ„ä¸Šå„è‡ªé—­åˆï¼Œæ¯”å¦‚å‰éƒ¨åˆ†åŒ…å«å¿…è¦çš„çˆ¶èŠ‚ç‚¹ç›´åˆ°targetï¼Œå¹¶é—­åˆæ‰€æœ‰æ ‡ç­¾ï¼›åéƒ¨åˆ†ä»targetå¼€å§‹ï¼Œå¹¶ä¸”æœ‰çˆ¶èŠ‚ç‚¹çš„å¼€å§‹æ ‡ç­¾ï¼Œä»¥ä¾¿ç»“æ„æ­£ç¡®ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä¾‹å¦‚ï¼Œå‡è®¾åŸç»“æ„æ˜¯ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>body &gt; div.container &gt; div.main &gt; p#target</span></span>
<span class="line"><span></span></span>
<span class="line"><span>å‰éƒ¨åˆ†åº”è¯¥ç”Ÿæˆï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>body &gt; div.container &gt; div.main &gt; p#target</span></span>
<span class="line"><span></span></span>
<span class="line"><span>åéƒ¨åˆ†ç”Ÿæˆï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>p#target çš„çˆ¶ç»“æ„æ˜¯ div.main &gt; div.container &gt; bodyï¼Œä½†åéƒ¨åˆ†éœ€è¦ä»p#targetå¼€å§‹ï¼Œæ‰€ä»¥ç»“æ„åº”è¯¥æ˜¯ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;div.main&gt;&lt;div.container&gt;&lt;body&gt;ï¼ˆä½†bodyä¸èƒ½åµŒå¥—åœ¨divé‡Œï¼Œè¿™æ˜¾ç„¶æœ‰é—®é¢˜ï¼‰</span></span>
<span class="line"><span></span></span>
<span class="line"><span>è¿™è¯´æ˜ç›´æ¥å…‹éš†çˆ¶ç»“æ„å¯èƒ½ä¼šå¯¼è‡´ä¸æ­£ç¡®çš„åµŒå¥—ï¼Œå°¤å…¶æ˜¯å½“çˆ¶å…ƒç´ æ˜¯åƒbodyè¿™æ ·çš„é¡¶å±‚å…ƒç´ æ—¶ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>å› æ­¤ï¼Œå¯èƒ½éœ€è¦å¦ä¸€ç§æ–¹æ³•ï¼šç”Ÿæˆä¸¤ä¸ªHTMLç‰‡æ®µï¼Œå‰éƒ¨åˆ†åŒ…å«åˆ°targetä¸ºæ­¢çš„æ‰€æœ‰ç¥–å…ˆï¼Œæ¯ä¸ªç¥–å…ˆèŠ‚ç‚¹åªåŒ…å«åˆ°targetåŠå…¶ä¹‹å‰çš„å…„å¼ŸèŠ‚ç‚¹ï¼Œå¹¶é—­åˆæ‰€æœ‰æ ‡ç­¾ã€‚åéƒ¨åˆ†åˆ™åŒ…å«targetåŠå…¶ä¹‹åçš„å…„å¼ŸèŠ‚ç‚¹ï¼Œå¹¶åœ¨å‰é¢è¡¥å…¨ç¥–å…ˆçš„å¼€å§‹æ ‡ç­¾ï¼Œä½†å¦‚ä½•è¡¥å…¨è¿™äº›å¼€å§‹æ ‡ç­¾ï¼Ÿ</span></span>
<span class="line"><span></span></span>
<span class="line"><span>æˆ–è€…ï¼Œå¯ä»¥è€ƒè™‘å°†å‰éƒ¨åˆ†å’Œåéƒ¨åˆ†ä½œä¸ºä¸¤ä¸ªæ–‡æ¡£ç‰‡æ®µï¼Œå…¶ä¸­å‰éƒ¨åˆ†çš„ç»“æ„æ˜¯åŸå§‹ç»“æ„çš„ä¸€éƒ¨åˆ†ï¼Œç›´åˆ°targetï¼Œå¹¶ä¸”è‡ªåŠ¨é—­åˆæ‰€æœ‰çˆ¶æ ‡ç­¾ï¼›åéƒ¨åˆ†çš„ç»“æ„åˆ™æ˜¯ä»targetå¼€å§‹ï¼Œå¹¶ä¸”å‰é¢è‡ªåŠ¨æ‰“å¼€çˆ¶æ ‡ç­¾ï¼Œç›´åˆ°æ ¹ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä½†å¦‚ä½•å®ç°è¿™ä¸€ç‚¹å‘¢ï¼Ÿ</span></span>
<span class="line"><span></span></span>
<span class="line"><span>å¦ä¸€ç§æ€è·¯æ˜¯ï¼Œå‰éƒ¨åˆ†å¯ä»¥é€šè¿‡å°†targetä¹‹åçš„æ‰€æœ‰å…„å¼ŸèŠ‚ç‚¹åˆ é™¤ï¼Œç„¶åå–å…¶çˆ¶èŠ‚ç‚¹çš„outerHTMLã€‚ä½†æ˜¯è¿™æ ·ä¼šä¿®æ”¹åŸå§‹DOMï¼Œä¸å¯è¡Œã€‚æ‰€ä»¥éœ€è¦ä½¿ç”¨å…‹éš†çš„æ–¹å¼ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä¾‹å¦‚ï¼Œå‰éƒ¨åˆ†çš„å¤„ç†æ­¥éª¤ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>1. å…‹éš†æ•´ä¸ªæ–‡æ¡£çš„bodyå…ƒç´ ï¼ˆæˆ–è€…æŒ‡å®šçš„æ ¹å…ƒç´ ï¼‰ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>2. åœ¨å…‹éš†ä¸­ï¼Œæ‰¾åˆ°å¯¹åº”çš„targetèŠ‚ç‚¹ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>3. ä»targetçš„çˆ¶èŠ‚ç‚¹å¼€å§‹ï¼Œåˆ é™¤targetä¹‹åçš„æ‰€æœ‰å…„å¼ŸèŠ‚ç‚¹ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>4. é€’å½’å‘ä¸Šå¤„ç†æ‰€æœ‰çˆ¶èŠ‚ç‚¹ï¼Œç¡®ä¿æ¯ä¸ªçˆ¶èŠ‚ç‚¹åªä¿ç•™åˆ°å½“å‰å¤„ç†èŠ‚ç‚¹çš„ä½ç½®ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ç±»ä¼¼åœ°ï¼Œåéƒ¨åˆ†çš„å¤„ç†ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>1. å…‹éš†æ•´ä¸ªæ–‡æ¡£çš„bodyå…ƒç´ ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>2. æ‰¾åˆ°å¯¹åº”çš„targetèŠ‚ç‚¹ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>3. åˆ é™¤targetä¹‹å‰çš„æ‰€æœ‰å…„å¼ŸèŠ‚ç‚¹ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>4. é€’å½’å‘ä¸Šå¤„ç†çˆ¶èŠ‚ç‚¹ï¼Œç¡®ä¿çˆ¶èŠ‚ç‚¹åªä¿ç•™ä»å½“å‰èŠ‚ç‚¹å¼€å§‹çš„éƒ¨åˆ†ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä½†è¿™æ ·å¯èƒ½éœ€è¦ä¿®æ”¹å…‹éš†çš„DOMç»“æ„ï¼Œç¡®ä¿æ¯ä¸ªçˆ¶èŠ‚ç‚¹åªä¿ç•™å¿…è¦çš„å­èŠ‚ç‚¹ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä¾‹å¦‚ï¼Œå®ç°å‰éƒ¨åˆ†çš„å…‹éš†ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function cloneAndPruneAfter(node, clonedNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>let current = clonedNode;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>let original = node;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>while (current.parentNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const originalParent = original.parentNode;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const clonedParent = current.parentNode;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const siblings = Array.from(originalParent.childNodes);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const index = siblings.indexOf(original);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// åœ¨å…‹éš†çš„çˆ¶èŠ‚ç‚¹ä¸­ï¼Œåˆ é™¤indexä¹‹åçš„æ‰€æœ‰å­èŠ‚ç‚¹</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const clonedSiblings = Array.from(clonedParent.childNodes);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>for (let i = clonedSiblings.length - 1; i &gt; index; i--) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>clonedParent.removeChild(clonedSiblings[i]);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>current = clonedParent;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>original = originalParent;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>return current; // è¿”å›æ ¹å…‹éš†èŠ‚ç‚¹</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ç„¶åï¼Œä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥å¤„ç†å…‹éš†çš„èŠ‚ç‚¹ã€‚ä¾‹å¦‚ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const originalRoot = document.documentElement; // å‡è®¾æ•´ä¸ªæ–‡æ¡£</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const clonedRoot = originalRoot.cloneNode(true);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const clonedTarget = clonedRoot.querySelector(&#39;#target&#39;); // éœ€è¦æ‰¾åˆ°å¯¹åº”çš„å…‹éš†èŠ‚ç‚¹</span></span>
<span class="line"><span></span></span>
<span class="line"><span>cloneAndPruneAfter(node, clonedTarget);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>è¿™æ ·ï¼ŒclonedRootå°†åªåŒ…å«åˆ°targetä¸ºæ­¢çš„ç»“æ„ã€‚ç„¶åï¼Œå¯ä»¥å°†clonedRootçš„outerHTMLä½œä¸ºå‰éƒ¨åˆ†çš„HTMLã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>åŒç†ï¼Œåéƒ¨åˆ†éœ€è¦å…‹éš†æ•´ä¸ªç»“æ„ï¼Œç„¶ååˆ é™¤targetä¹‹å‰çš„å…„å¼ŸèŠ‚ç‚¹ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function cloneAndPruneBefore(node, clonedNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>let current = clonedNode;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>let original = node;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>while (current.parentNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const originalParent = original.parentNode;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const clonedParent = current.parentNode;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const siblings = Array.from(originalParent.childNodes);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const index = siblings.indexOf(original);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// åˆ é™¤indexä¹‹å‰çš„æ‰€æœ‰å­èŠ‚ç‚¹</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const clonedSiblings = Array.from(clonedParent.childNodes);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>for (let i = 0; i &lt; index; i++) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>clonedParent.removeChild(clonedSiblings[i]);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>current = clonedParent;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>original = originalParent;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>return current;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä½†è¿™é‡Œçš„é—®é¢˜æ˜¯ï¼Œå½“å…‹éš†æ•´ä¸ªæ–‡æ¡£æ—¶ï¼Œå¦‚ä½•æ‰¾åˆ°å¯¹åº”çš„å…‹éš†èŠ‚ç‚¹ï¼Ÿå› ä¸ºå¦‚æœç”¨æˆ·ä¼ å…¥çš„nodeæ˜¯åŸå§‹æ–‡æ¡£ä¸­çš„èŠ‚ç‚¹ï¼Œå…‹éš†åçš„èŠ‚ç‚¹åœ¨å…‹éš†æ ‘ä¸­çš„ä½ç½®å¯èƒ½ä¸åŒï¼Œéœ€è¦æ‰¾åˆ°å¯¹åº”çš„å…‹éš†èŠ‚ç‚¹ã€‚è¿™å¯èƒ½éœ€è¦ä¸€ä¸ªæ˜ å°„ï¼Œæˆ–è€…é€šè¿‡é€‰æ‹©å™¨é‡æ–°æŸ¥è¯¢ï¼Œä½†è¿™å¯èƒ½ä¸å¯é ï¼Œå°¤å…¶æ˜¯å½“æœ‰å¤šä¸ªç›¸åŒé€‰æ‹©å™¨çš„æƒ…å†µä¸‹ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>è¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·ä¼ å…¥ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¦æ‰¾åˆ°å®ƒåœ¨å…‹éš†æ ‘ä¸­çš„å¯¹åº”èŠ‚ç‚¹ï¼Œå¯èƒ½éœ€è¦éå†åŸå§‹æ ‘å’Œå…‹éš†æ ‘åŒæ­¥è¿›è¡Œï¼Œæˆ–è€…ç»™èŠ‚ç‚¹æ·»åŠ ä¸´æ—¶IDï¼Œç„¶ååœ¨å…‹éš†æ ‘ä¸­æŸ¥æ‰¾ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>æˆ–è€…ï¼Œå¯ä»¥é€’å½’å…‹éš†ï¼Œå¹¶åœ¨å…‹éš†æ—¶è®°å½•åŸå§‹èŠ‚ç‚¹åˆ°å…‹éš†èŠ‚ç‚¹çš„æ˜ å°„ã€‚ä¾‹å¦‚ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function cloneNodeWithMap(node, map) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const clone = node.cloneNode(false); // æµ…å…‹éš†</span></span>
<span class="line"><span></span></span>
<span class="line"><span>map.set(node, clone);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>if (node.childNodes) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>node.childNodes.forEach(child =&gt; {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const childClone = cloneNodeWithMap(child, map);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>clone.appendChild(childClone);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>});</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>return clone;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const map = new Map();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const clonedRoot = cloneNodeWithMap(originalRoot, map);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const clonedTarget = map.get(originalTarget);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>è¿™æ ·ï¼Œmapä¼šä¿å­˜åŸå§‹èŠ‚ç‚¹åˆ°å…‹éš†èŠ‚ç‚¹çš„æ˜ å°„ï¼Œå¯ä»¥å¿«é€Ÿæ‰¾åˆ°å…‹éš†åçš„ç›®æ ‡èŠ‚ç‚¹ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ç„¶åï¼Œå¯¹å‰éƒ¨åˆ†å’Œåéƒ¨åˆ†è¿›è¡Œå¤„ç†ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>å¤„ç†å‰éƒ¨åˆ†ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>cloneAndPruneAfter(clonedTarget, clonedRoot);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const frontHtml = clonedRoot.outerHTML;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>å¤„ç†åéƒ¨åˆ†ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>cloneAndPruneBefore(clonedTarget, clonedRoot);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const backHtml = clonedRoot.outerHTML;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>è¿™å¯èƒ½æ˜¯ä¸€ä¸ªå¯è¡Œçš„æ–¹æ³•ã€‚ä½†éœ€è¦æ³¨æ„ï¼Œè¿™æ ·çš„æ“ä½œå¯èƒ½ä¼šå½±å“å…¶ä»–éƒ¨åˆ†ï¼Œæ¯”å¦‚äº‹ä»¶ç›‘å¬å™¨ã€å±æ€§ç­‰ï¼Œä½†ç”¨æˆ·å¯èƒ½åªéœ€è¦ç»“æ„ï¼Œä¸éœ€è¦äº‹ä»¶ç­‰ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>æ€»ç»“æ­¥éª¤ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>1. å…‹éš†æ•´ä¸ªDOMæ ‘ï¼ˆæˆ–æŒ‡å®šçš„æ ¹èŠ‚ç‚¹ï¼‰ï¼Œå¹¶å»ºç«‹åŸå§‹èŠ‚ç‚¹åˆ°å…‹éš†èŠ‚ç‚¹çš„æ˜ å°„ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>2. æ‰¾åˆ°å…‹éš†åçš„ç›®æ ‡èŠ‚ç‚¹ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>3. å¯¹äºå‰éƒ¨åˆ†ï¼Œä»ç›®æ ‡èŠ‚ç‚¹å‘ä¸Šéå†ï¼Œåˆ é™¤æ¯ä¸ªçˆ¶èŠ‚ç‚¹ä¸­ç›®æ ‡èŠ‚ç‚¹ä¹‹åçš„æ‰€æœ‰å…„å¼ŸèŠ‚ç‚¹ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>4. å¯¹äºåéƒ¨åˆ†ï¼ŒåŒæ ·å‘ä¸Šéå†ï¼Œåˆ é™¤æ¯ä¸ªçˆ¶èŠ‚ç‚¹ä¸­ç›®æ ‡èŠ‚ç‚¹ä¹‹å‰çš„æ‰€æœ‰å…„å¼ŸèŠ‚ç‚¹ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>5. å°†å¤„ç†åçš„å…‹éš†æ ‘çš„outerHTMLè¾“å‡ºï¼Œå¾—åˆ°å‰éƒ¨åˆ†å’Œåéƒ¨åˆ†çš„HTMLå­—ç¬¦ä¸²ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä½†ç”¨æˆ·å¯èƒ½éœ€è¦çš„æ˜¯å°†åˆ†å‰²åçš„ä¸¤éƒ¨åˆ†ä½œä¸ºDOMèŠ‚ç‚¹ï¼Œè€Œä¸ä»…ä»…æ˜¯HTMLå­—ç¬¦ä¸²ã€‚æˆ–è€…ç”¨æˆ·å¯èƒ½éœ€è¦è¿”å›ä¸¤ä¸ªæ–‡æ¡£ç‰‡æ®µã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä½†é—®é¢˜æè¿°ä¸­æåˆ°â€œåˆ†å‰²åçš„domæ ‘ä¾æ—§å†…å®¹å®Œæ•´â€ï¼Œæ‰€ä»¥å¯èƒ½éœ€è¦ç”Ÿæˆä¸¤ä¸ªDOMç‰‡æ®µï¼Œæ¯ä¸ªéƒ½æ˜¯æœ‰æ•ˆçš„ç»“æ„ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ç°åœ¨ï¼Œæˆ‘éœ€è¦è€ƒè™‘å¦‚ä½•å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œå¹¶å¤„ç†å¯èƒ½å‡ºç°çš„è¾¹ç¼˜æƒ…å†µï¼Œæ¯”å¦‚ç›®æ ‡èŠ‚ç‚¹æ˜¯æ ¹èŠ‚ç‚¹ã€æ²¡æœ‰çˆ¶èŠ‚ç‚¹ã€æˆ–å¤„äºæ·±å±‚åµŒå¥—ç»“æ„ä¸­ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>å¯èƒ½çš„ä»£ç ç»“æ„ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function splitDOMAtNode(node) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// åˆ›å»ºåŸå§‹åˆ°å…‹éš†çš„æ˜ å°„</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const map = new Map();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function cloneTree(originalNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const clone = originalNode.cloneNode(false);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>map.set(originalNode, clone);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Array.from(originalNode.childNodes).forEach(child =&gt; {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>clone.appendChild(cloneTree(child));</span></span>
<span class="line"><span></span></span>
<span class="line"><span>});</span></span>
<span class="line"><span></span></span>
<span class="line"><span>return clone;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const clonedRoot = cloneTree(node.ownerDocument.documentElement);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const clonedNode = map.get(node);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// å‰éƒ¨åˆ†å¤„ç†ï¼šåˆ é™¤ç›®æ ‡èŠ‚ç‚¹ä¹‹åçš„æ‰€æœ‰å…„å¼ŸèŠ‚ç‚¹åŠå…¶å­æ ‘</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function pruneAfter(clonedNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>let current = clonedNode;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>while (current.parentNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const parent = current.parentNode;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const siblings = Array.from(parent.childNodes);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const index = siblings.indexOf(current);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>for (let i = siblings.length - 1; i &gt; index; i--) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>parent.removeChild(siblings[i]);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>current = parent;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// åéƒ¨åˆ†å¤„ç†ï¼šåˆ é™¤ç›®æ ‡èŠ‚ç‚¹ä¹‹å‰çš„æ‰€æœ‰å…„å¼ŸèŠ‚ç‚¹åŠå…¶å­æ ‘</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function pruneBefore(clonedNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>let current = clonedNode;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>while (current.parentNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const parent = current.parentNode;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const siblings = Array.from(parent.childNodes);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const index = siblings.indexOf(current);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>for (let i = 0; i &lt; index; i++) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>parent.removeChild(siblings[i]);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>current = parent;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// åˆ›å»ºå‰éƒ¨åˆ†å’Œåéƒ¨åˆ†çš„å…‹éš†</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const frontRoot = clonedRoot.cloneNode(true);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const frontClonedNode = map.get(node); // è¿™é‡Œå¯èƒ½æœ‰é”™è¯¯ï¼Œå› ä¸ºfrontRootæ˜¯æ–°çš„å…‹éš†ï¼Œä¹‹å‰çš„mapå¯èƒ½ä¸é€‚ç”¨</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// è¿™é‡Œå‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œå‰é¢çš„cloneTreeè¿”å›çš„æ˜¯åŸå§‹æ–‡æ¡£çš„å…‹éš†ï¼Œä½†å¦‚æœæˆ‘ä»¬å†æ¬¡å…‹éš†frontRootï¼Œé‚£ä¹ˆéœ€è¦é‡æ–°å»ºç«‹æ˜ å°„ï¼Œå¦åˆ™æ— æ³•æ‰¾åˆ°å¯¹åº”çš„clonedNodeã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// å› æ­¤ï¼Œæ­£ç¡®çš„æ–¹æ³•åº”è¯¥æ˜¯åˆ†åˆ«å…‹éš†ä¸¤æ¬¡ï¼Œä¸€æ¬¡ç”¨äºå‰éƒ¨åˆ†ï¼Œä¸€æ¬¡ç”¨äºåéƒ¨åˆ†ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// é‡æ–°è®¾è®¡ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// åˆ›å»ºå‰éƒ¨åˆ†çš„å…‹éš†æ ‘</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const frontClonedRoot = cloneTree(node.ownerDocument.documentElement);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const frontClonedNode = map.get(node);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>pruneAfter(frontClonedNode);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// åˆ›å»ºåéƒ¨åˆ†çš„å…‹éš†æ ‘</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const backClonedRoot = cloneTree(node.ownerDocument.documentElement);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const backClonedNode = map.get(node);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>pruneBefore(backClonedNode);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>return {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>front: frontClonedRoot,</span></span>
<span class="line"><span></span></span>
<span class="line"><span>back: backClonedRoot</span></span>
<span class="line"><span></span></span>
<span class="line"><span>};</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä½†è¿™é‡Œçš„é—®é¢˜æ˜¯ï¼ŒcloneTreeå‡½æ•°åœ¨ç¬¬äºŒæ¬¡è°ƒç”¨æ—¶ä¼šè¦†ç›–mapä¸­çš„å€¼ï¼Œå¯¼è‡´é”™è¯¯ã€‚å› æ­¤ï¼Œéœ€è¦åœ¨æ¯æ¬¡å…‹éš†æ—¶ä½¿ç”¨æ–°çš„mapã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä¿®æ”¹åçš„ä»£ç ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function splitDOMAtNode(originalNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function cloneTreeWithMap(root) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const map = new Map();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function clone(node) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const cloned = node.cloneNode(false);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>map.set(node, cloned);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Array.from(node.childNodes).forEach(child =&gt; {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>cloned.appendChild(clone(child));</span></span>
<span class="line"><span></span></span>
<span class="line"><span>});</span></span>
<span class="line"><span></span></span>
<span class="line"><span>return cloned;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const clonedRoot = clone(root);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>return { clonedRoot, map };</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const root = originalNode.ownerDocument.documentElement;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// å…‹éš†å‰éƒ¨åˆ†</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const { clonedRoot: frontRoot, map: frontMap } = cloneTreeWithMap(root);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const frontClonedNode = frontMap.get(originalNode);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>pruneAfter(frontClonedNode);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// å…‹éš†åéƒ¨åˆ†</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const { clonedRoot: backRoot, map: backMap } = cloneTreeWithMap(root);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const backClonedNode = backMap.get(originalNode);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>pruneBefore(backClonedNode);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>return {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>front: frontRoot,</span></span>
<span class="line"><span></span></span>
<span class="line"><span>back: backRoot</span></span>
<span class="line"><span></span></span>
<span class="line"><span>};</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function pruneAfter(clonedNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>let current = clonedNode;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>while (current.parentNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const parent = current.parentNode;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const siblings = Array.from(parent.childNodes);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const index = siblings.indexOf(current);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>for (let i = siblings.length - 1; i &gt; index; i--) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>parent.removeChild(siblings[i]);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>current = parent;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function pruneBefore(clonedNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>let current = clonedNode;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>while (current.parentNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const parent = current.parentNode;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const siblings = Array.from(parent.childNodes);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const index = siblings.indexOf(current);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>for (let i = 0; i &lt; index; i++) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>parent.removeChild(siblings[i]);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>current = parent;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>è¿™æ ·ï¼Œå‰éƒ¨åˆ†å’Œåéƒ¨åˆ†å„è‡ªç‹¬ç«‹å…‹éš†æ•´ä¸ªæ–‡æ¡£ï¼Œå¹¶åˆ†åˆ«è¿›è¡Œå¤„ç†ã€‚ç„¶åè¿”å›å¤„ç†åçš„å…‹éš†æ ¹èŠ‚ç‚¹ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>æµ‹è¯•ä¸€ä¸‹ï¼Œå‡è®¾åŸç»“æ„å¦‚ä¸‹ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;html&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;body&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;div class=&quot;container&quot;&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;p&gt;1&lt;/p&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;p id=&quot;target&quot;&gt;2&lt;/p&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;p&gt;3&lt;/p&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/div&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/body&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/html&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>è°ƒç”¨splitDOMAtNode(target)åï¼ŒfrontRootåº”è¯¥åŒ…å«ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;html&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;body&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;div class=&quot;container&quot;&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;p&gt;1&lt;/p&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;p id=&quot;target&quot;&gt;2&lt;/p&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/div&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/body&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/html&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>è€ŒbackRootåº”è¯¥åŒ…å«ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;html&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;body&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;div class=&quot;container&quot;&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;p id=&quot;target&quot;&gt;2&lt;/p&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;p&gt;3&lt;/p&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/div&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/body&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/html&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>è¿™æ ·ï¼Œä¸¤éƒ¨åˆ†çš„ç»“æ„éƒ½æ˜¯å®Œæ•´çš„ï¼Œé—­åˆæ­£ç¡®ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä½†å®é™…æµ‹è¯•ä¸­ï¼ŒpruneAfterå‡½æ•°ä¼šä»ç›®æ ‡èŠ‚ç‚¹å¼€å§‹ï¼Œå‘ä¸Šéå†æ¯ä¸ªçˆ¶èŠ‚ç‚¹ï¼Œåˆ é™¤åé¢çš„å…„å¼ŸèŠ‚ç‚¹ã€‚ä¾‹å¦‚ï¼Œåœ¨frontå…‹éš†ä¸­ï¼Œå¤„ç†div.containeræ—¶ï¼Œåˆ é™¤targetä¹‹åçš„pï¼Œå³ç¬¬ä¸‰ä¸ªpã€‚ç„¶ååœ¨bodyå’Œhtmlå±‚çº§ï¼Œç”±äºå®ƒä»¬æ²¡æœ‰å…¶ä»–å­èŠ‚ç‚¹åœ¨divä¹‹åï¼Œæ‰€ä»¥ä¸ä¼šæœ‰å˜åŒ–ã€‚å› æ­¤ï¼Œç”Ÿæˆçš„frontRootç»“æ„æ­£ç¡®ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>åŒæ ·ï¼Œbackå…‹éš†ä¸­ï¼Œå¤„ç†div.containeræ—¶ï¼Œåˆ é™¤targetä¹‹å‰çš„pï¼Œå³ç¬¬ä¸€ä¸ªpã€‚ç„¶åå‘ä¸Šéå†çˆ¶èŠ‚ç‚¹ï¼Œbodyå’Œhtmlä¸­æ²¡æœ‰å…¶ä»–å­èŠ‚ç‚¹åœ¨divä¹‹å‰ï¼Œå› æ­¤ç»“æ„æ­£ç¡®ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä½†è¿™ç§æ–¹æ³•æ˜¯å¦é€‚ç”¨äºæ›´å¤æ‚çš„åµŒå¥—ç»“æ„ï¼Ÿæ¯”å¦‚ï¼Œå¦‚æœç›®æ ‡èŠ‚ç‚¹åœ¨ä¸€ä¸ªåˆ—è¡¨ä¸­çš„æŸä¸ªæ·±å±‚ä½ç½®ï¼Œçˆ¶èŠ‚ç‚¹å¯èƒ½æœ‰å¤šä¸ªå±‚çº§ï¼Œæ¯ä¸ªå±‚çº§éƒ½éœ€è¦ä¿®å‰ªã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä¾‹å¦‚ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;html&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;body&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;div&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;ul&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;li&gt;A&lt;/li&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;li&gt;B</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;ul&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;li&gt;C&lt;/li&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;li id=&quot;target&quot;&gt;D&lt;/li&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;li&gt;E&lt;/li&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/ul&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/li&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;li&gt;F&lt;/li&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/ul&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/div&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/body&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/html&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>å¤„ç†åçš„å‰éƒ¨åˆ†åº”è¯¥åŒ…å«åˆ°idä¸ºtargetçš„liä¸ºæ­¢ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;div&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;ul&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;li&gt;A&lt;/li&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;li&gt;B</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;ul&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;li&gt;C&lt;/li&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;li id=&quot;target&quot;&gt;D&lt;/li&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/ul&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/li&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/ul&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/div&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>åéƒ¨åˆ†åº”è¯¥ä»targetå¼€å§‹ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;div&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;ul&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;li&gt;B</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;ul&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;li id=&quot;target&quot;&gt;D&lt;/li&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;li&gt;E&lt;/li&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/ul&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/li&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;li&gt;F&lt;/li&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/ul&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/div&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä½†æ ¹æ®pruneAfterçš„å¤„ç†ï¼Œå½“å¤„ç†åˆ°li#targetçš„çˆ¶ulæ—¶ï¼Œä¼šåˆ é™¤å…¶åçš„liã€‚ç„¶åå‘ä¸Šå¤„ç†li Bçš„çˆ¶ulï¼Œåˆ é™¤å…¶åçš„li Fã€‚å†å‘ä¸Šå¤„ç†divï¼Œåˆ é™¤å…¶åå¯èƒ½å­˜åœ¨çš„å…„å¼ŸèŠ‚ç‚¹ï¼Ÿå¦‚æœdivæ˜¯å”¯ä¸€çš„å­èŠ‚ç‚¹ï¼Œåˆ™ä¸ä¼šæœ‰å˜åŒ–ã€‚æœ€ç»ˆå‰éƒ¨åˆ†çš„ç»“æ„æ­£ç¡®ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>è€ŒpruneBeforeåœ¨å¤„ç†åéƒ¨åˆ†æ—¶ï¼Œä¼šåˆ é™¤targetä¹‹å‰çš„li Cï¼Œç„¶ååœ¨çˆ¶ulä¸­ï¼Œåˆ é™¤å‰é¢çš„å…„å¼ŸèŠ‚ç‚¹ã€‚åŒæ ·ï¼Œçˆ¶li Bçš„ulä¸­ï¼Œåˆ é™¤å‰é¢çš„li Aï¼Œç„¶ååœ¨divçš„ulä¸­ï¼Œåˆ é™¤å‰é¢çš„å…„å¼ŸèŠ‚ç‚¹ã€‚å¯èƒ½ç»“æ„ä¼šæ˜¯ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;div&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;ul&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;li&gt;B</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;ul&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;li id=&quot;target&quot;&gt;D&lt;/li&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;li&gt;E&lt;/li&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/ul&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/li&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;li&gt;F&lt;/li&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/ul&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;/div&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>è¿™ç¬¦åˆé¢„æœŸã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>å› æ­¤ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯å¯è¡Œçš„ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ç°åœ¨ï¼Œå¦‚ä½•å°†è¿™ä¸ªé€»è¾‘è½¬åŒ–ä¸ºJavaScriptä»£ç ï¼Œå¹¶å¤„ç†å¯èƒ½çš„è¾¹ç¼˜æƒ…å†µï¼Ÿ</span></span>
<span class="line"><span></span></span>
<span class="line"><span>éœ€è¦æ³¨æ„çš„é—®é¢˜ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>1. å¦‚ä½•å…‹éš†æ•´ä¸ªæ–‡æ¡£ï¼ŒåŒ…æ‹¬htmlã€headã€bodyç­‰ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>2. å¦‚ä½•å¤„ç†ç›®æ ‡èŠ‚ç‚¹åœ¨æ ¹èŠ‚ç‚¹çš„æƒ…å†µã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>3. å¤„ç†æ–‡æœ¬èŠ‚ç‚¹å’Œå…¶ä»–ç±»å‹çš„èŠ‚ç‚¹ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>åœ¨ä»£ç ä¸­ï¼ŒcloneTreeWithMapå‡½æ•°ä¼šå…‹éš†ä¼ å…¥çš„æ ¹èŠ‚ç‚¹ï¼Œè¿™é‡Œå‡è®¾æ˜¯document.documentElementï¼Œå³htmlå…ƒç´ ã€‚ç„¶åé€’å½’å…‹éš†æ‰€æœ‰å­èŠ‚ç‚¹ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>pruneAfterå’ŒpruneBeforeå‡½æ•°é€šè¿‡éå†çˆ¶èŠ‚ç‚¹ï¼Œåˆ é™¤ä¸éœ€è¦çš„å…„å¼ŸèŠ‚ç‚¹ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>æµ‹è¯•æ—¶ï¼Œéœ€è¦ç¡®ä¿ç›®æ ‡èŠ‚ç‚¹å­˜åœ¨äºå…‹éš†æ ‘ä¸­ï¼Œå¹¶ä¸”æ­£ç¡®æ‰¾åˆ°å¯¹åº”çš„å…‹éš†èŠ‚ç‚¹ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ç°åœ¨ï¼Œç¼–å†™ä»£ç ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function splitDOMAtNode(originalNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// è¾…åŠ©å‡½æ•°ï¼šå…‹éš†æ ‘å¹¶å»ºç«‹æ˜ å°„</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function cloneTreeWithMap(root) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const map = new Map(); // ä¿å­˜åŸå§‹èŠ‚ç‚¹åˆ°å…‹éš†èŠ‚ç‚¹çš„æ˜ å°„</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function clone(node) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const cloned = node.cloneNode(false); // æµ…å…‹éš†ï¼Œä¸å…‹éš†å­èŠ‚ç‚¹</span></span>
<span class="line"><span></span></span>
<span class="line"><span>map.set(node, cloned);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// é€’å½’å…‹éš†å­èŠ‚ç‚¹</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Array.from(node.childNodes).forEach(child =&gt; {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>cloned.appendChild(clone(child));</span></span>
<span class="line"><span></span></span>
<span class="line"><span>});</span></span>
<span class="line"><span></span></span>
<span class="line"><span>return cloned;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const clonedRoot = clone(root);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>return { clonedRoot, map };</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// ä¿®å‰ªå‡½æ•°ï¼šåˆ é™¤ç›®æ ‡èŠ‚ç‚¹ä¹‹åçš„æ‰€æœ‰å…„å¼ŸèŠ‚ç‚¹</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function pruneAfter(clonedNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>let current = clonedNode;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>while (current.parentNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const parent = current.parentNode;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const siblings = Array.from(parent.childNodes);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const index = siblings.indexOf(current);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// åˆ é™¤å½“å‰èŠ‚ç‚¹ä¹‹åçš„æ‰€æœ‰å…„å¼ŸèŠ‚ç‚¹</span></span>
<span class="line"><span></span></span>
<span class="line"><span>for (let i = siblings.length - 1; i &gt; index; i--) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>parent.removeChild(siblings[i]);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>current = parent; // å‘ä¸Šå¤„ç†çˆ¶èŠ‚ç‚¹</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// ä¿®å‰ªå‡½æ•°ï¼šåˆ é™¤ç›®æ ‡èŠ‚ç‚¹ä¹‹å‰çš„æ‰€æœ‰å…„å¼ŸèŠ‚ç‚¹</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function pruneBefore(clonedNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>let current = clonedNode;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>while (current.parentNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const parent = current.parentNode;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const siblings = Array.from(parent.childNodes);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const index = siblings.indexOf(current);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// åˆ é™¤å½“å‰èŠ‚ç‚¹ä¹‹å‰çš„æ‰€æœ‰å…„å¼ŸèŠ‚ç‚¹</span></span>
<span class="line"><span></span></span>
<span class="line"><span>for (let i = 0; i &lt; index; i++) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>parent.removeChild(siblings[i]);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>current = parent; // å‘ä¸Šå¤„ç†çˆ¶èŠ‚ç‚¹</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// è·å–åŸå§‹æ–‡æ¡£çš„æ ¹èŠ‚ç‚¹</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const root = originalNode.ownerDocument.documentElement;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// å…‹éš†å¹¶å¤„ç†å‰éƒ¨åˆ†</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const { clonedRoot: frontRoot, map: frontMap } = cloneTreeWithMap(root);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const frontClonedNode = frontMap.get(originalNode);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>if (!frontClonedNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>throw new Error(&#39;Target node not found in cloned tree&#39;);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>pruneAfter(frontClonedNode);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// å…‹éš†å¹¶å¤„ç†åéƒ¨åˆ†</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const { clonedRoot: backRoot, map: backMap } = cloneTreeWithMap(root);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const backClonedNode = backMap.get(originalNode);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>if (!backClonedNode) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>throw new Error(&#39;Target node not found in cloned tree&#39;);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>pruneBefore(backClonedNode);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>return {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>front: frontRoot,</span></span>
<span class="line"><span></span></span>
<span class="line"><span>back: backRoot</span></span>
<span class="line"><span></span></span>
<span class="line"><span>};</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>è¿™ä¸ªå‡½æ•°è¿”å›åŒ…å«å‰éƒ¨åˆ†å’Œåéƒ¨åˆ†å…‹éš†æ ¹èŠ‚ç‚¹çš„å¯¹è±¡ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡outerHTMLå±æ€§è·å–å®ƒä»¬çš„HTMLå­—ç¬¦ä¸²ï¼Œæˆ–è€…è¿›ä¸€æ­¥æ“ä½œã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä¾‹å¦‚ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const target = document.getElementById(&#39;target&#39;);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const { front, back } = splitDOMAtNode(target);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>console.log(front.outerHTML); // å‰éƒ¨åˆ†çš„HTML</span></span>
<span class="line"><span></span></span>
<span class="line"><span>console.log(back.outerHTML); // åéƒ¨åˆ†çš„HTML</span></span>
<span class="line"><span></span></span>
<span class="line"><span>éœ€è¦æ³¨æ„ï¼Œè¿™ç§æ–¹æ³•ä¼šå…‹éš†æ•´ä¸ªæ–‡æ¡£ï¼ŒåŒ…æ‹¬headå’Œbodyï¼Œè¿™åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½ä¸æ˜¯ç”¨æˆ·éœ€è¦çš„ã€‚ç”¨æˆ·å¯èƒ½å¸Œæœ›åªå¤„ç†æŸä¸ªå­æ ‘ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ–‡æ¡£ã€‚å› æ­¤ï¼Œå¯èƒ½éœ€è¦ä¿®æ”¹å‡½æ•°ï¼Œå…è®¸ç”¨æˆ·æŒ‡å®šæ ¹èŠ‚ç‚¹ï¼Œé»˜è®¤ä¸ºdocument.documentElementã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>æ”¹è¿›åçš„å‡½æ•°å¯ä»¥æ¥å—ä¸€ä¸ªrootå‚æ•°ï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function splitDOMAtNode(originalNode, root = originalNode.ownerDocument.documentElement) {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// ...å…¶ä½™ä»£ç åŒå‰ï¼Œä½¿ç”¨ä¼ å…¥çš„rootä½œä¸ºå…‹éš†çš„æ ¹</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>è¿™æ ·ç”¨æˆ·å¯ä»¥é€‰æ‹©åˆ†å‰²æŸä¸ªå­æ ‘ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ–‡æ¡£ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>å¦å¤–ï¼Œéœ€è¦è€ƒè™‘åŸå§‹Nodeæ˜¯å¦åœ¨ä¼ å…¥çš„rootå­æ ‘ä¸­ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ˜ å°„å¤±è´¥ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä½†ä¸ºäº†ç®€åŒ–ï¼Œå‡è®¾ç”¨æˆ·ä¼ å…¥çš„originalNodeåœ¨rootå­æ ‘ä¸­ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ç»¼ä¸Šæ‰€è¿°ï¼Œæœ€ç»ˆçš„ä»£ç åº”è¯¥èƒ½å¤Ÿå¤„ç†å¤§éƒ¨åˆ†æƒ…å†µï¼Œç”Ÿæˆæ­£ç¡®åˆ†å‰²çš„ä¸¤ä¸ªDOMæ ‘ã€‚</span></span></code></pre></div></details></div><!--[--><div class="content-after-container"><div class="share-container"><div class="vp-share-buttons" style=""><!--[--><button type="button" class="vp-share-button" aria-label="qrcode" data-balloon-pos="up"><div class="vp-share-icon colorful" style="background:#999;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path d="M409.6 68H136.533c-37.5 0-68 31-68 68v273.6c0 37.547 31 68 68 68H409.6c37.547 0 68-31 68-68V136.533c0-37.5-31-68-68-68zm-68 256c0 9-8 17-17 17H222.2c-9 0-17-8-17-17V221.6c0-9 8-17 17-17h102.4c9 0 17 8 17 17V324zM887.734 68H614.4c-37.547 0-68 31-68 68v273.6c0 37.547 31 68 68 68h273c37.5 0 68-31 68-68V136.533c0-37.5-31-68-68-68zm-68 256c0 9-8 17-17 17h-102.4c-9 0-17-8-17-17V221.6c0-9 8-17 17-17h102.4c9 0 17 8 17 17V324zM409.6 546.133H136.533c-37.5 0-68 31-68 68v273c0 37.5 31 68 68 68H409.6c37.547 0 68-31 68-68V614.4c0-37.547-31-68-68-68zm-68 256c0 9-8 17-17 17H222.2c-9 0-17-8-17-17v-102.4c0-9 8-17 17-17h102.4c9 0 17 8 17 17v102.4zm580-86.4H785V768c0 9.5-8 17-17 17h-52v137.6c0 18.8 15 34 34.134 34.133H921.6c18.8 0 34.133-15 34.133-34.133V749.8c0-18.774-15-34.134-34.133-34.134zm-204.8-137.6c0-18.8-15-34.133-34.133-34.133H579.2c-18.8 0-34 15-34 34.133v104.534c0 18.8 15 34 34 34.133h103.467c18.8 0 34.133-15 34.133-34.133V578.133zm-85.333 275.2H563.2c-9.5 0-17 8-17 17v68c0 9.5 8 17 17 17h68c9.5 0 17-8 17-17V870.4c0-9.5-8-17-17-17zm307.2-307.2H870.4c-9.5 0-17 8-17 17v68c0 9.5 8 17 17 17h68c9.5 0 17-8 17-17V563.2c0-9.5-8-17-17-17z"/></svg></div></button><!----><!--]--><!--[--><button type="button" class="vp-share-button" aria-label="qq" data-balloon-pos="up"><div class="vp-share-icon colorful" style="background:#5eaade;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path d="M863 626c-17-58-38-107-70-186 5-209-82-378-281-378-202 0-286 172-281 378-32 80-52 128-70 186-39 123-26 174-17 175 20 3 79-93 79-93 0 56 28 127 89 179-29 9-96 34-80 61 13 21 220 14 280 7 60 7 267 14 280-7 16-27-51-52-80-61 61-52 89-124 89-179 0 0 59 96 79 93 9-1 22-52-17-175"/></svg></div></button><!----><!--]--><!--[--><button type="button" class="vp-share-button" aria-label="weibo" data-balloon-pos="up"><div class="vp-share-icon colorful" style="background:#D52C2B;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path d="M440 817c-148 13-277-53-286-148-11-96 102-185 252-200 148-15 277 52 286 148 11 96-103 185-252 200m299-319c-14-3-23-6-15-23 13-34 15-66 0-87-29-40-110-39-201-1 0 0-29 12-21-11 13-43 12-81-11-102-49-50-181 1-294 113-85 82-135 171-135 248 0 146 191 235 378 235 245 0 407-140 407-252 0-66-57-103-108-120m162-266c-59-65-147-89-227-72-19 4-30 21-27 40 5 18 23 29 41 26 58-12 120 4 162 51 40 43 54 105 36 162-6 18 3 36 20 42h1c18 6 37-4 43-21 27-79 8-168-49-228"/><path d="M811 311c-29-30-71-43-111-34-17 3-26 18-23 33v1c3 16 18 26 35 23 19-4 40 2 54 17 15 15 18 36 12 54a29 29 0 0 0 19 37c15 5 32-4 38-19 12-39 3-82-24-112M449 642c-6 9-18 14-27 9-9-3-10-12-6-21 5-9 17-13 26-9 9 3 12 12 7 21m-48 61a57 57 0 0 1-69 22 39 39 0 0 1-15-59c15-22 44-31 68-22 22 10 30 36 16 59m54-160c-70-18-151 17-181 78-32 62-2 131 70 154 74 24 162-12 192-80 30-66-7-134-81-152"/></svg></div></button><!----><!--]--><!--[--><button type="button" class="vp-share-button" aria-label="evernote" data-balloon-pos="up"><div class="vp-share-icon colorful" style="background:#14cc45;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path d="M300 111v113H187z"/><path d="M872 280s5-100-96-134c0 0-116-16-196-15 0 0-11-69-135-69 0 0-116-2-116 91v80s3 20-36 20H187s-45 7-45 94c0 0 4 156 54 260 0 0 12 45 75 60 0 0 125 33 161 28 0 0 76 29 81-145 0 0 5-25 8 15 0 0-2 90 75 94 0 0 59 17 96 13 0 0 49 3 49 84 0 0 17 93-45 93h-85s-24 5-24-29c0 0-6-28 34-28h20v-57h-56s-86-8-86 65v97s12 65 86 65h158s63 1 99-117c0 0 64-236 30-565M661 491c0-28 23-66 51-66s48 47 48 75c-38-10-60-12-99-9"/></svg></div></button><!----><!--]--><!--[--><button type="button" class="vp-share-button" aria-label="email" data-balloon-pos="up"><div class="vp-share-icon colorful" style="background:#1384FF;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path d="M152 177h720c49 0 89 37 90 83L512 494 63 260c0-46 40-83 89-83M62 349v414c0 46 41 84 90 84h720c49 0 90-38 90-84V349L523 572a24 24 0 0 1-22 0z"/></svg></div></button><!----><!--]--><!--[--><button type="button" class="vp-share-button" aria-label="facebook" data-balloon-pos="up"><div class="vp-share-icon colorful" style="background:#3c599b;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path d="M295 360h93v-91c0-40 1-101 30-139 30-41 72-68 144-68 118 0 168 17 168 17l-24 138s-39-12-75-12-69 13-69 50v105h149l-10 134H562v468H388V494h-93z"/></svg></div></button><!----><!--]--><!--[--><button type="button" class="vp-share-button" aria-label="twitter" data-balloon-pos="up"><div class="vp-share-icon colorful" style="background:#000;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path d="m587 451 291-339h-69L555 407 354 112H120l305 446-305 354h68l268-310 213 310h235zM214 163h107l488 699H702z"/></svg></div></button><!----><!--]--></div></div></div><!--]--><!----><!----></div><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/FuckDoctors/notes2/edit/main/docs/posts/dev/hello-deepseek.md" aria-label="ç¼–è¾‘æ­¤é¡µ" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">æœ€è¿‘æ›´æ–°</span><time class="vp-meta-info" datetime="2025-03-11T03:58:39.000Z" data-allow-mismatch>2025/3/11 03:58</time></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 413853119@qq.com">FuckDoctors</span><!--]--><!--]--></div></div></footer><!----><div id="comment" class="waline-wrapper vp-comment" vp-comment darkmode="false" style="display:block;"><!----></div><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">æ¬¢è¿æ¥åˆ°èµµæ–Œçš„å°ç«™ | ç”± <a href="https://theme-hope.vuejs.press" target="_blank">Theme Hope</a> é©±åŠ¨</div><div class="vp-copyright">Copyright Â© 2025 Zhao Bin </div></footer></div><!--]--><!--]--><!--[--><!----><!--[--><!--]--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/assets/app-DwlqzNfg.js" defer></script>
  </body>
</html>
